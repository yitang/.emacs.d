<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Unified Emacs OS - An Statistician's Implementation</title>
<!-- 2015-01-26 Mon 01:16 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Yi Tang" />
<link rel="stylesheet" type="text/css"
href="http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/foundation.min.css"></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/org-export.css"></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/blog/wp-content/themes/sacha-v3/style.css"></link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<a name="top" id="top"></a>
</div>
<div id="content">
<h1 class="title">Unified Emacs OS - An Statistician's Implementation</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">About This Document</a></li>
<li><a href="#sec-2">Licence</a></li>
<li><a href="#sec-3">Getting Started</a></li>
<li><a href="#sec-4">Emacs Configuration</a>
<ul>
<li><a href="#sec-4-1">General</a>
<ul>
<li><a href="#sec-4-1-1">Initialise</a></li>
<li><a href="#sec-4-1-2">Assorted Pieces</a></li>
<li><a href="#sec-4-1-3">Window Navigation</a></li>
<li><a href="#sec-4-1-4">Utilities</a></li>
<li><a href="#sec-4-1-5">System Path</a></li>
<li><a href="#sec-4-1-6">open stree map</a></li>
</ul>
</li>
<li><a href="#sec-4-2">Completion and Selection</a>
<ul>
<li><a href="#sec-4-2-1">Helm - Partial-match Selection</a></li>
<li><a href="#sec-4-2-2">Multi-Cursor - Multiple Selection</a></li>
<li><a href="#sec-4-2-3">Expand-Region - Incremental Selection</a></li>
</ul>
</li>
<li><a href="#sec-4-3">File Manager</a>
<ul>
<li><a href="#sec-4-3-1">Projectile - Directory Access</a></li>
<li><a href="#sec-4-3-2">dired - File Operation</a></li>
<li><a href="#sec-4-3-3">Remote (SSH)</a></li>
<li><a href="#sec-4-3-4">Git Sync</a></li>
</ul>
</li>
<li><a href="#sec-4-4">ESS - Emacs Speaks Statistics</a>
<ul>
<li><a href="#sec-4-4-1">Programming Mode</a></li>
<li><a href="#sec-4-4-2">Documentation</a></li>
<li><a href="#sec-4-4-3">R Style Check - Flycheck</a></li>
<li><a href="#sec-4-4-4">Remote R Sessions</a></li>
</ul>
</li>
<li><a href="#sec-4-5">mu4e - Email Client</a>
<ul>
<li><a href="#sec-4-5-1">Account</a></li>
<li><a href="#sec-4-5-2">Contacts</a></li>
<li><a href="#sec-4-5-3">Workflow</a></li>
<li><a href="#sec-4-5-4"><span class="todo TODO">TODO</span> Comprehensive Email</a></li>
</ul>
</li>
<li><a href="#sec-4-6">Emacs Looks Cool</a>
<ul>
<li><a href="#sec-4-6-1">Theme</a></li>
<li><a href="#sec-4-6-2">Modeline</a></li>
</ul>
</li>
<li><a href="#sec-4-7">Writing in Emacs</a>
<ul>
<li><a href="#sec-4-7-1">English Language</a></li>
<li><a href="#sec-4-7-2">Random Quotes</a></li>
<li><a href="#sec-4-7-3">Abbreviation</a></li>
</ul>
</li>
<li><a href="#sec-4-8">Org mode</a>
<ul>
<li><a href="#sec-4-8-1">Bernt Hansen's Setting</a>
<ul>
<li><a href="#sec-4-8-1-1">Agenda</a></li>
</ul>
</li>
<li><a href="#sec-4-8-2">PDF Export</a>
<ul>
<li><a href="#sec-4-8-2-1"><span class="todo TODO">TODO</span> fix xelatex compilation problem</a></li>
</ul>
</li>
<li><a href="#sec-4-8-3">HTML Export</a></li>
<li><a href="#sec-4-8-4">Blogging with Jekyll</a>
<ul>
<li><a href="#sec-4-8-4-1">code highlight</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-4-9">Initialisation Completed</a></li>
</ul>
</li>
<li><a href="#sec-5">Babel Library</a>
<ul>
<li><a href="#sec-5-1">Update Emacs library</a></li>
<li><a href="#sec-5-2">Ledger</a></li>
<li><a href="#sec-5-3">image process</a></li>
<li><a href="#sec-5-4">org contact</a></li>
<li><a href="#sec-5-5">Blog</a></li>
</ul>
</li>
<li><a href="#sec-6">End</a></li>
<li><a href="#sec-7">C++</a></li>
<li><a href="#sec-8">test</a></li>
</ul>
</div>
</div>
<p>

</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">About This Document</h2>
<div class="outline-text-2" id="text-1">
<p>

</p>

<p>
I have tried to use Emacs for many years, and really start to use it at 2014-Jun.  I would recommand Emacs for normal usage, but for me, there are few milestphone.  
</p>

<p>
first, I find myself spent more and more time in scaning the documents I write and deprised about lossing lecture notes, but on the otherhand, it imporrsible to get the notes immediately when I needed it.  
</p>

<p>
second, after I start to work as an Statisticiain, due to the workload, I need an system to keep project log, include decisoin made, code, progress report, email or meeting discussion etc.  I was adviced to use Office to do it, but it such a pain, and I find most of people don't do it.  
</p>

<p>
third, when I find the solution for the second problem, using org-mode to implememnt Literate Data Analysis, I am happy about norang's setting for a long time, and try to avoid dig into Emacs.  but when the data becomes physically big, it won't able to practise it locally, and I realise the ESS provide remote session, and it completely blow my mind.  I can run a R seesion on the server just like it was on my computer, how fanstatistic is that?  everything is the same.  
</p>

<p>
then I deivided to learn Emacs Lisp langauge to build a unified system that I can use on my personal PC, VM, server, and they are all the same!  
</p>

<p>
As my ocnifigration grows bigger and bigger, I deifinidelty need an way to orgnise, test and expand it.  previously, I have about 7 <code>.el</code> file, for exmaple, <code>setup-org.el</code>, <code>setup-email.el</code>, and I document on each file.  the downside of physcially separete is that I cannot modulate it easily.  Inpisraed by Sachua's new posts, I think it would be an brilliant idea to org emac configration code into one single org file, letting along the conviencen of orgnising and share my seetting, the precious thing I would appreciate is it provide an way I could start with a long comments, thoughts or workflow.  in this way, the code becomes less important as it should be.  
</p>

<p>
Normally you could tangle a org file to extract all the source code into one file, that you could use.  But I would like to push liteartpr programming furture in two aspects:  1) the source code takes input from this org file, I.e. table.  2) it facility Babel Library to integrate not only Emacs Lisp, but also sh and R functions that could be run in Emacs, and I found it particullary useful. 
</p>

<p>
but yo could still use most of the settings.  
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Licence</h2>
<div class="outline-text-2" id="text-2">
<p>

</p>

<pre class="example">
Copyright (C)  2013  Yi Tang
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
  
Code in this document is free software: you can redistribute it
and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation, either
version 3 of the License, or (at your option) any later version.
  
This code is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
</pre>

<p>
This document <a href="http://yi-tang.github.io/org-mode.html">http://yi-tang.github.io/org-mode.html</a> (either in its HTML format or in its Org format) is licensed under the GNU Free Documentation License version 1.3 or later (<a href="http://www.gnu.org/copyleft/fdl.html">http://www.gnu.org/copyleft/fdl.html</a>).
</p>

<p>
The code examples and CSS stylesheets are licensed under the GNU General Public License v3 or later (<a href="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</a>).
</p>
</div>
</div>



<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Getting Started</h2>
<div class="outline-text-2" id="text-3">
<p>

</p>

<p>
question I want to answer 
</p>

<ol class="org-ol">
<li>why I need this/that package, what functionality they provide.
</li>
<li>how to improve the current work flow,
</li>
<li></li>
</ol>

<p>
About this file: 
Use this 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-confirm-babel-evaluate nil<span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">evaluate src block without confirmation </span>

<span class="org-comment-delimiter">;;;;;;; </span><span class="org-comment">[2015-01-22 Thu 21:27]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">endless/init.org-message-depth</span> 5
  <span class="org-doc">"What depth of init.org headers to message at startup."</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">with-temp-buffer</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>insert-file <span class="org-string">"~/git/.emacs.d/yt/init.org"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>goto-char <span class="org-rainbow-delimiters-depth-3">(</span>point-min<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">org babels </span>
  <span class="org-rainbow-delimiters-depth-2">(</span>search-forward <span class="org-string">"\n* Babel Library"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-copy-subtree<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>tmp-file <span class="org-rainbow-delimiters-depth-5">(</span>make-temp-file <span class="org-string">"tmp"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">with-temp-file</span> tmp-file <span class="org-rainbow-delimiters-depth-4">(</span>yank<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-babel-lob-ingest tmp-file<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">emacs lisp functions </span>
  <span class="org-rainbow-delimiters-depth-2">(</span>goto-char <span class="org-rainbow-delimiters-depth-3">(</span>point-min<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>search-forward <span class="org-string">"\n* init.el"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>eobp<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Report Headers</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>looking-at
       <span class="org-rainbow-delimiters-depth-6">(</span>format <span class="org-string">"\\*\\{2,%s\\} +.*$"</span> 
               endless/init.org-message-depth<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>message <span class="org-string">"%s"</span> <span class="org-rainbow-delimiters-depth-6">(</span>match-string 0<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Evaluate Code Blocks</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>looking-at <span class="org-string">"^#\\+BEGIN_SRC +emacs-lisp.*$"</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">((looking-at "^#\\+BEGIN_SRC +.*$")</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>org-babel-execute-src-block<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Finish on the next level-1 header</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>looking-at <span class="org-string">"^\\* End"</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>goto-char <span class="org-rainbow-delimiters-depth-6">(</span>point-max<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
or this 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>setq user-emacs-directory <span class="org-string">"~/git/.emacs.d/"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-babel-load-file 
 <span class="org-rainbow-delimiters-depth-2">(</span>expand-file-name <span class="org-string">"init.org"</span>
                   user-emacs-directory<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Emacs Configuration</h2>
<div class="outline-text-2" id="text-4">
<p>

</p>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">General</h3>
<div class="outline-text-3" id="text-4-1">
</div><div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1">Initialise</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">package</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"melpa"</span> . <span class="org-string">"http://melpa.milkbox.net/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"org"</span> . <span class="org-string">"http://orgmode.org/elpa/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"melpa"</span> . <span class="org-string">"http://melpa.milkbox.net/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>package-initialize<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'load-path <span class="org-string">"~/git/.emacs.d/lisp"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>default-directory <span class="org-string">"~/git/.emacs.d/.cask"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>normal-top-level-add-subdirs-to-load-path<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-1-2" class="outline-4">
<h4 id="sec-4-1-2">Assorted Pieces</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">ref: http://stackoverflow.com/questions/151945/how-do-i-control-how-emacs-makes-backup-files</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">save all backup files (foo~) to this directory.</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq backup-directory-alist '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"."</span> . <span class="org-string">"~/.emacs.d/backup"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
      backup-by-copying t    <span class="org-comment-delimiter">; </span><span class="org-comment">Don't delink hardlinks</span>
      version-control t      <span class="org-comment-delimiter">; </span><span class="org-comment">Use version numbers on backups</span>
      delete-old-versions t  <span class="org-comment-delimiter">; </span><span class="org-comment">Automatically delete excess backups</span>
      kept-new-versions 20   <span class="org-comment-delimiter">; </span><span class="org-comment">how many of the newest versions to keep</span>
      kept-old-versions 5    <span class="org-comment-delimiter">; </span><span class="org-comment">and how many of the old</span>
      auto-save-timeout 20   <span class="org-comment-delimiter">; </span><span class="org-comment">number of seconds idle time before auto-save (default: 30)</span>
      auto-save-interval 200 <span class="org-comment-delimiter">; </span><span class="org-comment">number of keystrokes between auto-saves (default: 300)</span>
      <span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">guide-key package </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">guide-key</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq guide-key/guide-key-sequence t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">on for all key-bindings </span>
<span class="org-rainbow-delimiters-depth-1">(</span>guide-key-mode 1<span class="org-rainbow-delimiters-depth-1">)</span> 

                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">start auto-complete with emacs</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">auto-complete</span><span class="org-rainbow-delimiters-depth-1">)</span>
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">do default config for auto-complete</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">auto-complete-config</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>ac-config-default<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'yasnippet)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(yas-global-mode 1)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-snippet-dirs '("~/git/.emacs.d/my-snippets"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">"~/git/.emacs.d/.cask/24.4.2/elpa/yasnippet-20141102.1554/snippets"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">"~/git/.emacs.d/.cask/25.0.50.1/elpa/yasnippet-20141102.1554/snippets"))</span>

<span class="org-rainbow-delimiters-depth-1">(</span>recentf-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq recentf-max-saved-items 200
      recentf-max-menu-items 15<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-string">"\C-r"</span> 'helm-recentf<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>setq inhibit-startup-message t<span class="org-rainbow-delimiters-depth-1">)</span>        <span class="org-comment-delimiter">; </span><span class="org-comment">Disable startup message</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-1-3" class="outline-4">
<h4 id="sec-4-1-3">Window Navigation</h4>
<div class="outline-text-4" id="text-4-1-3">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">;;; winner-mode, undo window configration</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">winner-mode</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>winner-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">winner-undo -&gt; C-c &lt;left&gt;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">winner-redo -&gt; C-c &lt;right&gt;</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">visible notication for invalid options </span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq visible-bell t<span class="org-rainbow-delimiters-depth-1">)</span> 

<span class="org-comment-delimiter">;; </span><span class="org-comment">move between windows, alternatives: window_number.el</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x &lt;up&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'windmove-up<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x &lt;down&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'windmove-down<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x &lt;right&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'windmove-right<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x &lt;left&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'windmove-left<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">golden-ratio</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>golden-ratio-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">prefer horizentally split window</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq split-height-threshold nil)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(setq split-width-threshold 0)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-1-4" class="outline-4">
<h4 id="sec-4-1-4">Utilities</h4>
<div class="outline-text-4" id="text-4-1-4">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Change "yes or no" to "y or n"</span>
<span class="org-rainbow-delimiters-depth-1">(</span>fset 'yes-or-no-p 'y-or-n-p<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/reload-dot-emacs</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Save the .emacs buffer if needed, then reload .emacs."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>dot-emacs <span class="org-string">"~/.emacs"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>and <span class="org-rainbow-delimiters-depth-4">(</span>get-file-buffer dot-emacs<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>save-buffer <span class="org-rainbow-delimiters-depth-5">(</span>get-file-buffer dot-emacs<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>load-file dot-emacs<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Re-initialized!"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/delete-this-buffer-and-file</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Removes file connected to current buffer and kills buffer."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>filename <span class="org-rainbow-delimiters-depth-5">(</span>buffer-file-name<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>buffer <span class="org-rainbow-delimiters-depth-5">(</span>current-buffer<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>name <span class="org-rainbow-delimiters-depth-5">(</span>buffer-name<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>not <span class="org-rainbow-delimiters-depth-5">(</span>and filename <span class="org-rainbow-delimiters-depth-6">(</span>file-exists-p filename<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-warning">error</span> <span class="org-string">"Buffer '%s' is not visiting a file!"</span> name<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-5">(</span>yes-or-no-p <span class="org-string">"Are you sure you want to remove this file? "</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>delete-file filename<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>kill-buffer buffer<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>message <span class="org-string">"File '%s' successfully removed"</span> filename<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">full path of current buffer</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/copy-full-path-to-kill-ring</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"copy buffer's full path to kill ring"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> buffer-file-name
    <span class="org-rainbow-delimiters-depth-3">(</span>kill-new <span class="org-rainbow-delimiters-depth-4">(</span>file-truename buffer-file-name<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">[</span>C-f1<span class="org-rainbow-delimiters-depth-2">]</span> 'yt/copy-full-path-to-kill-ring<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-1-5" class="outline-4">
<h4 id="sec-4-1-5">System Path</h4>
<div class="outline-text-4" id="text-4-1-5">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">osx, work with homebrew </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">set-exec-path-from-shell-PATH</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>path-from-shell 
         <span class="org-rainbow-delimiters-depth-5">(</span>replace-regexp-in-string <span class="org-string">"[[:space:]\n]*$"</span> <span class="org-string">""</span> 
                                   <span class="org-rainbow-delimiters-depth-6">(</span>shell-command-to-string <span class="org-string">"$SHELL -l -c 'echo $PATH'"</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setenv <span class="org-string">"PATH"</span> path-from-shell<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq exec-path <span class="org-rainbow-delimiters-depth-4">(</span>split-string path-from-shell path-separator<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>equal system-type 'darwin<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>set-exec-path-from-shell-PATH<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">modify mac keyboard </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>eq system-type 'darwin<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>fset 'insertPound <span class="org-string">"#"</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>global-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-3"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'insertPound<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>setq ispell-program-name <span class="org-string">"/usr/local/bin/aspell"</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>setq mac-command-modifier 'meta<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>global-unset-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-`"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>global-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-`"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'other-frame<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>global-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-Z"</span><span class="org-rainbow-delimiters-depth-4">)</span> nil<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>prefer-coding-system 'utf-8<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>display-graphic-p<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq x-select-request-type '<span class="org-rainbow-delimiters-depth-3">(</span>UTF8_STRING COMPOUND_TEXT TEXT STRING<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">windows path convention</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setenv <span class="org-string">"CYGWIN"</span> <span class="org-string">"nodosfilewarning"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-1-6" class="outline-4">
<h4 id="sec-4-1-6">open stree map</h4>
<div class="outline-text-4" id="text-4-1-6">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">omap_bbox</span> <span class="org-rainbow-delimiters-depth-2">(</span>minlon minlat maxlon maxlat<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"generate to hyperlink and also view an area in openstreemap.  </span>
<span class="org-doc">the area is defined by the bounding box. "</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>address <span class="org-rainbow-delimiters-depth-5">(</span>concat  <span class="org-string">"http://www.openstreetmap.org/?"</span>
           <span class="org-string">"minlon="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string minlon<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&amp;"</span>
           <span class="org-string">"minlat="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string minlat<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&amp;"</span>
           <span class="org-string">"maxlon="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string maxlon<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&amp;"</span>
           <span class="org-string">"maxlat="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string maxlat<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&amp;"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>browse-url address<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>kill-new address<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">omap_point</span> <span class="org-rainbow-delimiters-depth-2">(</span>lon lat<span class="org-rainbow-delimiters-depth-2">)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>address <span class="org-rainbow-delimiters-depth-5">(</span>concat  <span class="org-string">"http://www.openstreetmap.org/?"</span>
                          <span class="org-string">"mlat="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string lat<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&amp;"</span>
                          <span class="org-string">"mlon="</span> <span class="org-rainbow-delimiters-depth-6">(</span>number-to-string lon<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>browse-url address<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>kill-new address<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">omap_site</span> <span class="org-rainbow-delimiters-depth-2">(</span>site<span class="org-rainbow-delimiters-depth-2">)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>address <span class="org-rainbow-delimiters-depth-5">(</span>concat <span class="org-string">"http://nominatim.openstreetmap.org/search.php?q="</span> site<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>browse-url address<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>kill-new address<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">omap</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= 1 <span class="org-rainbow-delimiters-depth-5">(</span>length arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>omap_site <span class="org-rainbow-delimiters-depth-5">(</span>nth 0 arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= 2 <span class="org-rainbow-delimiters-depth-5">(</span>length arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>omap_point <span class="org-rainbow-delimiters-depth-5">(</span>nth 0 arg<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>nth 1 arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= 4 <span class="org-rainbow-delimiters-depth-5">(</span>length arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>omap_bbox <span class="org-rainbow-delimiters-depth-5">(</span>nth 0 arg<span class="org-rainbow-delimiters-depth-5">)</span>
                     <span class="org-rainbow-delimiters-depth-5">(</span>nth 1 arg<span class="org-rainbow-delimiters-depth-5">)</span>
                     <span class="org-rainbow-delimiters-depth-5">(</span>nth 2 arg<span class="org-rainbow-delimiters-depth-5">)</span>
                     <span class="org-rainbow-delimiters-depth-5">(</span>nth 3 arg<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>t <span class="org-string">"nope"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '(-0.489 51.28 0.236 51.686)) ;; london area</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.openstreetmap.org/?minlon=-0.489&amp;minlat=51.28&amp;maxlon=0.236&amp;maxlat=51.686&amp;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '(-76.3412 38.6710)) ;; New york </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.openstreetmap.org/?mlat=38.671&amp;mlon=-76.3412</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '("UK"))  ;; UK, obvs </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://nominatim.openstreetmap.org/search.php?q=UK</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Completion and Selection</h3>
<div class="outline-text-3" id="text-4-2">
<p>

</p>
</div>
<div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1">Helm - Partial-match Selection</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>

</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">helm </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">helm-config</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>helm-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">helm-swoop</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Change the keybinds to whatever you like :)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-i") 'helm-swoop)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-I") 'helm-swoop-back-to-last-point)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c M-i") 'helm-multi-swoop)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x M-i") 'helm-multi-swoop-all)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f1&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-swoop<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">When doing isearch, hand the word over to helm-swoop</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key isearch-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-i"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-swoop-from-isearch<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">From helm-swoop to helm-multi-swoop-all</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key helm-swoop-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-i"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-multi-swoop-all-from-helm-swoop<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">When doing evil-search, hand the word over to helm-swoop</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key evil-motion-state-map (kbd "M-i") 'helm-swoop-from-evil-search)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Save buffer when helm-multi-swoop-edit complete</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq helm-multi-swoop-edit-save t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">If this value is t, split window inside the current window</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq helm-swoop-split-with-multiple-windows nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Split direcion. 'split-window-vertically or 'split-window-horizontally</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq helm-swoop-split-direction 'split-window-vertically<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">If nil, you can slightly boost invoke speed in exchange for text color</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq helm-swoop-speed-or-color nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">----------------------------------------------------------------------</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-b"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-buffers-list<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2">Multi-Cursor - Multiple Selection</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>

</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">multiple-cursors</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-c C-S-c"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/edit-lines<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-&gt;") 'mc/mark-next-like-this)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-&lt;") 'mc/mark-previous-like-this)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C-&lt;") 'mc/mark-all-like-this)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-&lt;right&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/mark-next-like-this<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-&lt;left&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/mark-previous-like-this<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c C-&lt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/mark-all-like-this<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3">Expand-Region - Incremental Selection</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">[[https://github.com/magnars/expand-region.el][expand-region]]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">expand-region</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-="</span><span class="org-rainbow-delimiters-depth-2">)</span> 'er/expand-region<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">File Manager</h3>
<div class="outline-text-3" id="text-4-3">
<p>

</p>
</div>
<div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1">Projectile - Directory Access</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">projectile</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">helm-projectile</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>projectile-global-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq projectile-enable-caching t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq projectile-switch-project-action 'projectile-dired<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq projectile-remember-window-configs t <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq projectile-completion-system 'helm<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-3-2" class="outline-4">
<h4 id="sec-4-3-2">dired - File Operation</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>

</p>
</div>
</div>
<div id="outline-container-sec-4-3-3" class="outline-4">
<h4 id="sec-4-3-3">Remote (SSH)</h4>
<div class="outline-text-4" id="text-4-3-3">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">tramp</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ssh</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/sync-local-remote</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-string">"copy all files in remote:~/LR_share to local:~/LR_share,</span>
<span class="org-string">does not support the ther way"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"/ssh:JBA28:/home/local/JBANORTHWEST/yitang/LR_share"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(mark-whole-buffer)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>dired-mark-subdir-files<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(find-file "~/LR_share")</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-local dirqed-dwim-target t)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>dired-do-copy<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-3-4" class="outline-4">
<h4 id="sec-4-3-4">Git Sync</h4>
<div class="outline-text-4" id="text-4-3-4">
<p>

</p>


<p>
Magit is an amazing package, it used to use command line for lal git work, and usually a task involve a series of command.  it good for a beginning to learn, by repeat each command agaigna and aigagnain, and hwo to combine them and do a complex task.  but onec I familaried with it, it is not necessary to do it anymore.  This is why I start to use Magit.  it is an absolute aamzing package, it is intuitive, it is the GUI, the command to use etc.  I would highly recommand it, even to someone has very bsic knowldege of Git, you can find a manuam at <a href="http://magit.github.io/master/magit.html">http://magit.github.io/master/magit.html</a> and cheatsheet <a href="http://daemianmack.com/magit-cheatsheet.html">http://daemianmack.com/magit-cheatsheet.html</a>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">backup git repo automatically </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">git</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">magit</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
I use Emacs/org-mode as a unified system to do everything, at home, on Macbook Pro, on office, Windows/Ubuntu.  I used to use Dropbox/Copy to automateally synised the files onm ulti machine, and oceanally I used the time machine feature to find missing files, and also, files are got overwritted, I lose track.
</p>

<p>
the good thing about Git is that yoou can see what exactlly has been changed by each version, and auto log, with commit information and timesatmp.  Magit helps me to do ti conviently but I need 3 more features: 
</p>
<ol class="org-ol">
<li>automatically save all the buffers
I have been runing into the sitatuion that my office machine was frzzee, beacuse of Big Data and I push R to the limits, and I potentially will lose the newstest version of sripcts.  which is bit annoy.
</li>
<li>office rush,
I shared lift with my coluge, and someimes, I just need to go, and go now! than what I did is  to call a function that will deal with commits, update, and upload.
</li>
<li>automatically commit 
few times I did some work over the weenend and night, and I want to udpate to my colluge, but I gotget to sync, or push to the cloud&#x2026; which is quit embarralse. 
</li>
</ol>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">backup git repo automatically </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">git</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq git-sh-scripts <span class="org-string">"</span>
<span class="org-string">echo Start to Sync: $(date) </span>

<span class="org-string">REPOS=\"org jbarm\"</span>
<span class="org-string">for REPO in $REPOS</span>
<span class="org-string">do</span>
<span class="org-string">    echo</span>
<span class="org-string">    echo \"Repository: $REPO\"</span>
<span class="org-string">    cd ~/git/$REPO</span>
<span class="org-string">    # update</span>
<span class="org-string">    git pull </span>
<span class="org-string">    # Remove deleted files</span>
<span class="org-string">    git ls-files --deleted -z | xargs -0 git rm &gt;/dev/null 2&gt;&amp;1</span>
<span class="org-string">    # Add new files</span>
<span class="org-string">    git add -A . &gt;/dev/null 2&gt;&amp;1</span>
<span class="org-string">    git commit -m \"$(date)\"</span>
<span class="org-string">    git push origin master </span>
<span class="org-string">done</span>

<span class="org-string">echo Finished Sync: $(date)</span>
<span class="org-string">"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/git-backup</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">(call-process-shell-command "~/git/AutoCommit.sh" nil nil t)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(start-process-shell-command "git-sync" "*AutoSync*" "~/git/org/AutoSync.sh")</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>async-shell-command git-sh-scripts<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"all git sync... done"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/save-all-buffers</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"save all files-visiting buffers without user confirmation"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>save-some-buffers t nil<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"save all buffers... done"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/save-git-backup</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>yt/save-all-buffers<span class="org-rainbow-delimiters-depth-2">)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(display-buffer "*AutoSync*")</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>yt/git-backup<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>eq system-type 'darwin<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>run-at-time <span class="org-string">"05:59"</span> 10800 'yt/save-git-backup<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">ESS - Emacs Speaks Statistics</h3>
<div class="outline-text-3" id="text-4-4">
<p>
I am a Statistician, runing R and writing scripts is what I do most of the day.  I have tried many oyher way of running R, Rstudio, SublimeText, TextMate, but ended up in use ESS/Emacs.  
</p>

<p>
There are few killing points of ESS:
</p>

<ol class="org-ol">
<li>formatting 

<p>
it will do the amazing for you, just by hitting TAB, and I will see where I missed a ')', or ']'.  Also, it makes the long function call readable, with spelite it into multiples, but with nice lines.  here's an exmaple 
</p>
<div class="org-src-container">

<pre class="src src-r">rainfall.subset <span class="org-constant">&lt;-</span> data.table<span class="org-rainbow-delimiters-depth-1">(</span>rainfall.london,
                              rainfall.pairs,
                              rainfall.dublin<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</li>
</ol>


<ol class="org-ol">
<li>search command history

<p>
imamging you are producing a ggplot, and you realised there was something miss in the data, so you fix the data first, then run the ggplot command again, you press Up buttom many times, or just search once/two times, by <code>M-x ggplot( =, then press =C-r</code> to select.  
</p>
</li>

<li>the R session can be accesses by org-mode, 

<p>
last time I gogoled it about literate program, and the Rmarkdown does not support R session, so evertime you want to run a document, you need to start a new session and run thought everhting agian.  In this case, ESS and org-mode is more freindly to use. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Adapted with one minor change from Felipe Salazar at</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'load-path "~/git/.emacs.d/elpa/ess-13.09-1/lisp")</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ess-site</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq ess-ask-for-ess-directory nil<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">start R on default folder</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq ess-local-process-name <span class="org-string">"R"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq ansi-color-for-comint-mode 'filter<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;;</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq comint-scroll-to-bottom-on-input t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq comint-scroll-to-bottom-on-output t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq comint-move-point-for-output t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq ess-eval-visibly-p 'nowait<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">no waiting while ess evalating</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-ess-start-R</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>member <span class="org-string">"*R*"</span> <span class="org-rainbow-delimiters-depth-5">(</span>mapcar <span class="org-rainbow-delimiters-depth-6">(</span>function buffer-name<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>buffer-list<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">progn</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>delete-other-windows<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>setq w1 <span class="org-rainbow-delimiters-depth-5">(</span>selected-window<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>setq w1name <span class="org-rainbow-delimiters-depth-5">(</span>buffer-name<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>setq w2 <span class="org-rainbow-delimiters-depth-5">(</span>split-window w1 nil t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>R<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>set-window-buffer w2 <span class="org-string">"*R*"</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>set-window-buffer w1 w1name<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-ess-eval</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>my-ess-start-R<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>and transient-mark-mode mark-active<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>call-interactively 'ess-eval-region<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>call-interactively 'ess-eval-line-and-step<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'ess-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span><span class="org-rainbow-delimiters-depth-3">()</span>
             <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">[</span><span class="org-rainbow-delimiters-depth-5">(</span>shift return<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">]</span> 'my-ess-eval<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'inferior-ess-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span><span class="org-rainbow-delimiters-depth-3">()</span>
             <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">[</span>C-up<span class="org-rainbow-delimiters-depth-4">]</span> 'comint-previous-input<span class="org-rainbow-delimiters-depth-3">)</span>
             <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">[</span>C-down<span class="org-rainbow-delimiters-depth-4">]</span> 'comint-next-input<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'Rnw-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span><span class="org-rainbow-delimiters-depth-3">()</span>
             <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">[</span><span class="org-rainbow-delimiters-depth-5">(</span>shift return<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">]</span> 'my-ess-eval<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'ess-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>flyspell-prog-mode<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>run-hooks 'prog-mode-hook<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(prog-mode)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">...</span>
            <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'ess-site)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">REF: http://stackoverflow.com/questions/2901198/useful-keyboard-shortcuts-and-tips-for-ess-r</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Control and up/down arrow keys to search history with matching what you've already typed:</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key comint-mode-map <span class="org-rainbow-delimiters-depth-2">[</span>C-up<span class="org-rainbow-delimiters-depth-2">]</span> 'comint-previous-matching-input-from-input<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key comint-mode-map <span class="org-rainbow-delimiters-depth-2">[</span>C-down<span class="org-rainbow-delimiters-depth-2">]</span> 'comint-next-matching-input-from-input<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">C-b = list buffers</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-b") 'bs-show)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">;; ESS Mode (.R file)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(define-key ess-mode-map "\C-l" 'ess-eval-line-and-step)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(define-key ess-mode-map "\C-p" 'ess-eval-function-or-paragraph-and-step)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(define-key ess-mode-map "\C-r" 'ess-eval-region)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">use ess-transcript-clean-buffer to</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">1. clean *R* buffer, remove all outputs</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">2. save commands history</span>
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-sec-4-4-1" class="outline-4">
<h4 id="sec-4-4-1">Programming Mode</h4>
<div class="outline-text-4" id="text-4-4-1">
<p>
After 2014, Emacs comes a prog-mode, for programming langauge.  it is generic mode, just like text-mode, that sits underneth all the programming language, either R, phython, C++ etc.  The good thinkg to have this concept is that we can define few things that will apply to all these mode, when we write scripts.  
</p>

<p>
One thing I find particulaar usefull and necessary is to highliht  characters in comments that has particullar meaning, like TODO, FIXME or other.  which can be particular handy in code reivew, I can navite and jump between the code quickly. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">highlights </span><span class="org-warning">FIXME</span><span class="org-comment">: </span><span class="org-warning">TODO</span><span class="org-comment">: and </span><span class="org-warning">BUG</span><span class="org-comment">: in prog-mode </span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>font-lock-add-keywords nil
                                    '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">YT</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">FIXME</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">TODO</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">BUG</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">:"</span> 1 font-lock-warning-face t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
we usually have long scripts, and in Subimetext, one cold folder and unfolder a function. in Emacs, this feature could be extended to furture, by define folder-characters.  at this statge, I tented to used the deafault, I.e. folder functions only.  in the folliwng setting, I could press <code>F3</code> to folder/unfolder a function, <code>C-F3</code> or <code>S-F3</code> to folder/unfolder all functions. 
</p>

<p>
one potentially solution is to use <code>org-strct-mode</code>, to show/hide the whole section, I havne;t tryied it before, but it sounds a good idea.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'hs-minor-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f3&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'hs-toggle-hiding<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f3&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'hs-show-all<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">S-&gt;show </span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f3&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'hs-hide-all<span class="org-rainbow-delimiters-depth-1">)</span> 
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-block                      C-c @ C-h</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-show-block                      C-c @ C-s</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-all                        C-c @ C-M-h</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-show-all                        C-c @ C-M-s</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-level                      C-c @ C-l</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-toggle-hiding </span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-mouse-toggle-hiding             [(shift mouse-2)]</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-initial-comment-block</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-d"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'comment-region<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">overwite delete-char </span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-d"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'uncomment-region<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-4-2" class="outline-4">
<h4 id="sec-4-4-2">Documentation</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">edit roxy template</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">ess-roxy-update-entry</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ess-roxy-template-alist '(("description" . " content for description")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("details" . "content for details")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("title" . "")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("param" . "")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("return" . "")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("export" . "")</span>
<span class="org-comment-delimiter">;;                                 </span><span class="org-comment">("author" . "Yi Tang")))</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-4-3" class="outline-4">
<h4 id="sec-4-4-3">R Style Check - Flycheck</h4>
<div class="outline-text-4" id="text-4-4-3">
<p>

</p>

<p>
<a href="https://github.com/jimhester/lintr">https://github.com/jimhester/lintr</a>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">flycheck</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'ess-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>flycheck-mode t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load <span class="org-string">"~/git/.emacs.d/lisp/lintr.el"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-4-4" class="outline-4">
<h4 id="sec-4-4-4">Remote R Sessions</h4>
<div class="outline-text-4" id="text-4-4-4">
<p>

</p>
</div>
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">mu4e - Email Client</h3>
<div class="outline-text-3" id="text-4-5">
<p>
The advantage of use Emacs as an email client: 
</p>

<ol class="org-ol">
<li>communication happens at the point where the content is genreated. 
as a statisician/programmer, most likely I need to mmunicate with numbers, table, graphs, or snippet.  I could just copy these results from to email, do an quickly editing.  
</li>
<li>HTML email with CSS style.  
I like to formate my email use headingline, fonts, and highlhgit the code, I used to be write a report in Word/LatEx and write an email with only onbe line, please see the attachment.  which I don't like. 
</li>
<li>search properly 
I use search all the time, and this functionality is not working at all in outlkooik 2013, it also shows up random info (mail.app in osx did a great job).  
</li>
</ol>

<p>
Disadvantage / can;t do: 
</p>
<ol class="org-ol">
<li>don't expect me to reply immediately 
this is how does it works: 1. download the email from server, 2) index with head, body, attachment, user name etc.  3) Emacs talk to and show in GUI.  I usually update the meail about 30 imnutes.  but I helps me out of disrupts.
</li>
<li>book Meeting/Appointment 
I didn't aware that you can do it in emacs, and we need an iterative way to do.  Outlook Schedule Asistant do a good job, it list agenda of all attendence, and I could spot oen time slot that suit for all or most people. 
</li>
<li>calendar 
I don't know how to integrate Office 365 calendar with Org-mode calandar yet.  even it can, I doubt I can download and see other people's agenda. 
</li>
</ol>

<p>
This setting need two programms to work: 1) mu, 2) offlineimap. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">usage:</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">$ offlineimap</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">$ mu index</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-x mu4e</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">from mu's official manual </span>
<span class="org-comment-delimiter">;;</span><span class="org-comment">----------------------------------------------------------</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'load-path <span class="org-string">"~/mu-master/mu4e"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">mu4e</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-mu-binary <span class="org-string">"/usr/local/bin/mu"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">default</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">don't save message to Sent Messages, Gmail/IMAP takes care of this</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-sent-messages-behavior 'sent<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">allow for updating mail using 'U' in the main view:</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-get-mail-command <span class="org-string">"offlineimap"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-update-interval 300<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">sending mail -- replace USERNAME with your gmail username</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">also, make sure the gnutls command line utils are installed</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">package 'gnutls-bin' in Debian/Ubuntu</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq smtpmail-default-smtp-server <span class="org-string">"smtpserver"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">needs to be specified before the (require)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">smtpmail</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">don't keep message buffers around</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq message-kill-buffer-on-exit t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">use 'fancy' non-ascii characters in various places in mu4e</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-use-fancy-chars t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">save attachment to my desktop (this can also be a function)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-attachment-dir <span class="org-string">"~/Desktop"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">attempt to show images when viewing messages</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-view-show-images t
      mu4e-show-images t
      mu4e-view-image-max-width 800<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-html2text-command <span class="org-string">"html2text -utf8 -width 72"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">nil "Shel command that converts HTML</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">yt</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-view-prefer-html t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">try to render </span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'mu4e-view-actions 
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"ViewInBrowser"</span> . mu4e-action-view-in-browser<span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">read in browser </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">mu4e as default email agent in emacs</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mail-user-agent 'mu4e-user-agent<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-mu4e</span><span class="org-rainbow-delimiters-depth-1">)</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">== M-x org-mu4e-compose-org-mode==</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-mu4e-convert-to-html t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">org -&gt; html</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">= M-m C-c.=</span>
</pre>
</div>
</div>


<div id="outline-container-sec-4-5-1" class="outline-4">
<h4 id="sec-4-5-1">Account</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-23 Fri 17:32]</span></span>
set up email account, use office 365 in the office, and iCloud at macbook por. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/mail-setup</span> <span class="org-rainbow-delimiters-depth-2">()</span> 
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>eq system-type 'gnu/linux<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq message-send-mail-function 'smtpmail-send-it
          smtpmail-stream-type 'starttls
          smtpmail-default-smtp-server <span class="org-string">"smtp.office365.com"</span>
          smtpmail-smtp-server <span class="org-string">"smtp.office365.com"</span>
          smtpmail-smtp-service 587
          smtpmail-smtp-user <span class="org-string">"yi.tang@jbarisk.com"</span>
          user-mail-address <span class="org-string">"yi.tang@jbarisk.com"</span>
          user-full-name  <span class="org-string">"Yi Tang"</span>
          mu4e-drafts-folder <span class="org-string">"/Drafts"</span>
          mu4e-sent-folder   <span class="org-string">"/Sent Items"</span>
          mu4e-trash-folder  <span class="org-string">"/Trash"</span>
          mu4e-maildir-shortcuts  '<span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/JBA/INBOX"</span>    . ?i<span class="org-rainbow-delimiters-depth-6">)</span>
                                    <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/Sent Items"</span>   . ?s<span class="org-rainbow-delimiters-depth-6">)</span>
                                    <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/Trash"</span>        . ?t<span class="org-rainbow-delimiters-depth-6">)</span>
                                    <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/All Mail"</span>     . ?a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          message-signature
          <span class="org-rainbow-delimiters-depth-5">(</span>concat
           <span class="org-string">"Yi Tang\n"</span>
           <span class="org-string">"Statistician\n"</span>
           <span class="org-string">"T: +44 (0) 1756 799919\n"</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"sent email via office365 email account"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>eq system-type 'darwin<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq message-send-mail-function 'smtpmail-send-it
          smtpmail-stream-type 'starttls
          smtpmail-default-smtp-server <span class="org-string">"smtp.mail.me.com"</span>
          smtpmail-smtp-server <span class="org-string">"smtp.mail.me.com"</span>
          smtpmail-smtp-service 587
          smtpmail-smtp-user <span class="org-string">"yi.tang.uk@me.com"</span>
          user-mail-address <span class="org-string">"yi.tang.uk@me.com"</span>
          user-full-name  <span class="org-string">"Yi Tang"</span>
          message-signature
          <span class="org-rainbow-delimiters-depth-5">(</span>concat
           <span class="org-string">"&#21776;&#27589; (Yi Tang)\n"</span>
           <span class="org-string">"Email: yi.tang.uk@me.com\n"</span>
           <span class="org-string">"\n"</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq mu4e-maildir <span class="org-string">"~/Maildir"</span><span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq mu4e-drafts-folder <span class="org-string">"/iCloud/Drafts"</span><span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq mu4e-sent-folder   <span class="org-string">"/iCloud/Sent Messages"</span><span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setq mu4e-trash-folder  <span class="org-string">"/iCloud/Deleted Messages"</span><span class="org-rainbow-delimiters-depth-4">)</span>

    <span class="org-rainbow-delimiters-depth-4">(</span>setq mu4e-maildir-shortcuts
          '<span class="org-rainbow-delimiters-depth-5">(</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/iCloud/INBOX"</span>               . ?i<span class="org-rainbow-delimiters-depth-6">)</span>
         <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/iCloud/Sent Messages"</span>   . ?s<span class="org-rainbow-delimiters-depth-6">)</span>
         <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-string">"/iCloud/Deleted Messages"</span>       . ?t<span class="org-rainbow-delimiters-depth-6">)</span>
         <span class="org-comment-delimiter">;; </span><span class="org-comment">("/iCloud.All Mail"    . ?a)</span>
         <span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

    <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"sent email via icloud email account"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>yt/mail-setup<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
when I sent an email, it will promote and ask for email, I only need type once per Emacs session, also, I can save the password to an <i>.authoty</i> file. 
</p>
</div>
</div>
<div id="outline-container-sec-4-5-2" class="outline-4">
<h4 id="sec-4-5-2">Contacts</h4>
<div class="outline-text-4" id="text-4-5-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-23 Fri 17:28]</span></span>
have problem with BBDB installtion, and use org-contact.el to manage contact.  add contactor very easy. I cna use tab to completet contacts, which is really handy.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-contacts</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq mu4e-org-contacts-file  <span class="org-string">"~/git/org/contacts.org"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'mu4e-headers-actions
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"org-contact-add"</span> . mu4e-action-add-org-contact<span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'mu4e-view-actions
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"org-contact-add"</span> . mu4e-action-add-org-contact<span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-3" class="outline-4">
<h4 id="sec-4-5-3">Workflow</h4>
<div class="outline-text-4" id="text-4-5-3">
<p>

</p>

<p>
I am trying to avoid use <code>C-x m</code> to write/sent email directy, unless it is really short. otherwise, if it relates to a project, I will make an org headline to keep track the project communciation, to do that,  I compose email/message in org mode, then sent the whole subtree by <code>C-c M-o</code>.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;;; </span><span class="org-comment">[2015-01-14 Wed 22:32]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">org-mime</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-mime</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-mime-library 'mml<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'message-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-string">"\C-c\M-o"</span> 'org-mime-htmlize<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-string">"\C-c\M-o"</span> 'org-mime-org-buffer-htmlize<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mime-html-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>insert-file-contents <span class="org-string">"~/git/.emacs.d/style/ofice.css"</span><span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(goto-char 5)</span>
            <span class="org-rainbow-delimiters-depth-2">)</span>
          t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-c M-o"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'org-mime-subtree<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
just in case I didn't get the format right at the first place and need some quick fix in message mode, save me few seconds in going back to org-mode.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'message-mode-hook 'orgstruct++-mode 'append<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'message-mode-hook 'turn-on-auto-fill 'append<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-mode-hook 'bbdb-define-all-aliases 'append)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'message-mode-hook 'orgtbl-mode 'append<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'message-mode-hook 'turn-on-flyspell 'append<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-mode-hook</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'(lambda () (setq fill-column 72))</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'append)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-4" class="outline-4">
<h4 id="sec-4-5-4"><span class="todo TODO">TODO</span> Comprehensive Email</h4>
<div class="outline-text-4" id="text-4-5-4">
<p>

</p>

<p>
<b>Attach and Inline Image</b> 
I got an email from an estate agency where there are few images are inlined, but also in the attachment.  why not just save the attachment online and inline the image as a normal HTML do? 
</p>

<ol class="org-ol">
<li>add an png attachment, display it as inline image.  
</li>
</ol>

<p>
<b>Render LaTeX code as image</b>
currently it is broken.  the error message is the path issues, and seems the file is not generated. 
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6">Emacs Looks Cool</h3>
<div class="outline-text-3" id="text-4-6">
<p>

</p>
</div>
<div id="outline-container-sec-4-6-1" class="outline-4">
<h4 id="sec-4-6-1">Theme</h4>
<div class="outline-text-4" id="text-4-6-1">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">rainbow-delimiters</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'rainbow-delimiters-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>show-paren-mode t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">for Emacs</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">cl-lib</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">color</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cl-loop</span>
 for index from 1 to rainbow-delimiters-max-face-count
 do
 <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>face <span class="org-rainbow-delimiters-depth-5">(</span>intern <span class="org-rainbow-delimiters-depth-6">(</span>format <span class="org-string">"rainbow-delimiters-depth-%d-face"</span> index<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span>cl-callf color-saturate-name <span class="org-rainbow-delimiters-depth-4">(</span>face-foreground face<span class="org-rainbow-delimiters-depth-4">)</span> 30<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>load-theme 'zenburn t<span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-comment-delimiter">;; </span><span class="org-comment">font</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-default-font <span class="org-string">"Source Code Pro"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'default nil <span class="org-builtin">:height</span> 140<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>






<p>
#+end_src
</p>
</div>
</div>
<div id="outline-container-sec-4-6-2" class="outline-4">
<h4 id="sec-4-6-2">Modeline</h4>
<div class="outline-text-4" id="text-4-6-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">nyan-mode</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>nyan-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">copy from http://amitp.blogspot.co.uk/2011/08/emacs-custom-mode-line.html</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Mode line setup</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq-default
 mode-line-format
 '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-comment-delimiter">; </span><span class="org-comment">Position, including warning for 80 columns</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:propertize</span> <span class="org-string">"%4l:"</span> face mode-line-position-face<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:eval</span> <span class="org-rainbow-delimiters-depth-4">(</span>propertize <span class="org-string">"%3c"</span> 'face
                      <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-6">(</span>&gt;= <span class="org-rainbow-delimiters-depth-7">(</span>current-column<span class="org-rainbow-delimiters-depth-7">)</span> 80<span class="org-rainbow-delimiters-depth-6">)</span>
                          'mode-line-80col-face
                        'mode-line-position-face<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">emacsclient [default -- keep?]</span>
   mode-line-client
   <span class="org-string">"  "</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">read-only or modified status</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:eval</span>
    <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-5">(</span>buffer-read-only
           <span class="org-rainbow-delimiters-depth-6">(</span>propertize <span class="org-string">" RO "</span> 'face 'mode-line-read-only-face<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>buffer-modified-p<span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>propertize <span class="org-string">" ** "</span> 'face 'mode-line-modified-face<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>t <span class="org-string">"      "</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-string">"    "</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">directory and buffer/file name</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:propertize</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-builtin">:eval</span> <span class="org-rainbow-delimiters-depth-5">(</span>shorten-directory default-directory 30<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                face mode-line-folder-face<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:propertize</span> <span class="org-string">"%b"</span>
                face mode-line-filename-face<span class="org-rainbow-delimiters-depth-3">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">narrow [default -- keep?]</span>
   <span class="org-string">" %n "</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">mode indicators: vc, recursive edit, major mode, minor modes, process, global</span>
   <span class="org-rainbow-delimiters-depth-3">(</span>vc-mode vc-mode<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-string">"  %["</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:propertize</span> mode-name
                face mode-line-mode-face<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-string">"%] "</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">(:eval (propertize (format-mode-line minor-mode-alist)</span>
   <span class="org-comment-delimiter">;;                    </span><span class="org-comment">'face 'mode-line-minor-mode-face))</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:propertize</span> mode-line-process
                face mode-line-process-face<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span>global-mode-string global-mode-string<span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-string">"    "</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">nyan-mode uses nyan cat as an alternative to %p</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:eval</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> nyan-mode <span class="org-rainbow-delimiters-depth-5">(</span>list <span class="org-rainbow-delimiters-depth-6">(</span>nyan-create<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Helper function</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">shorten-directory</span> <span class="org-rainbow-delimiters-depth-2">(</span>dir max-length<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Show up to `</span><span class="org-doc"><span class="org-constant">max-length</span></span><span class="org-doc">' characters of a directory name `</span><span class="org-doc"><span class="org-constant">dir</span></span><span class="org-doc">'."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>path <span class="org-rainbow-delimiters-depth-5">(</span>reverse <span class="org-rainbow-delimiters-depth-6">(</span>split-string <span class="org-rainbow-delimiters-depth-7">(</span>abbreviate-file-name dir<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-string">"/"</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>output <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-4">(</span>and path <span class="org-rainbow-delimiters-depth-5">(</span>equal <span class="org-string">""</span> <span class="org-rainbow-delimiters-depth-6">(</span>car path<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq path <span class="org-rainbow-delimiters-depth-5">(</span>cdr path<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-4">(</span>and path <span class="org-rainbow-delimiters-depth-5">(</span>&lt; <span class="org-rainbow-delimiters-depth-6">(</span>length output<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>- max-length 4<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq output <span class="org-rainbow-delimiters-depth-5">(</span>concat <span class="org-rainbow-delimiters-depth-6">(</span>car path<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"/"</span> output<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq path <span class="org-rainbow-delimiters-depth-5">(</span>cdr path<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> path
      <span class="org-rainbow-delimiters-depth-4">(</span>setq output <span class="org-rainbow-delimiters-depth-5">(</span>concat <span class="org-string">".../"</span> output<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    output<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Extra mode line faces</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-read-only-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-modified-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-folder-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-filename-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-position-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-mode-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-minor-mode-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-process-face<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>make-face 'mode-line-80col-face<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray60"</span> <span class="org-builtin">:background</span> <span class="org-string">"gray20"</span>
                    <span class="org-builtin">:inverse-video</span> nil
                    <span class="org-builtin">:box</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-builtin">:line-width</span> 6 <span class="org-builtin">:color</span> <span class="org-string">"gray20"</span> <span class="org-builtin">:style</span> nil<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-inactive nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray80"</span> <span class="org-builtin">:background</span> <span class="org-string">"gray40"</span>
                    <span class="org-builtin">:inverse-video</span> nil
                    <span class="org-builtin">:box</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-builtin">:line-width</span> 6 <span class="org-builtin">:color</span> <span class="org-string">"gray40"</span> <span class="org-builtin">:style</span> nil<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-read-only-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#4271ae"</span>
                    <span class="org-builtin">:box</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-builtin">:line-width</span> 2 <span class="org-builtin">:color</span> <span class="org-string">"#4271ae"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-modified-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#c82829"</span>
                    <span class="org-builtin">:background</span> <span class="org-string">"#ffffff"</span>
                    <span class="org-builtin">:box</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-builtin">:line-width</span> 2 <span class="org-builtin">:color</span> <span class="org-string">"#c82829"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-folder-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray60"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-filename-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#eab700"</span>
                    <span class="org-builtin">:weight</span> 'bold<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-position-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:family</span> <span class="org-string">"Menlo"</span> <span class="org-builtin">:height</span> 100<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-mode-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray80"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-minor-mode-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-mode-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray40"</span>
                    <span class="org-builtin">:height</span> 110<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-process-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"#718c00"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'mode-line-80col-face nil
                    <span class="org-builtin">:inherit</span> 'mode-line-position-face
                    <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:background</span> <span class="org-string">"#eab700"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7">Writing in Emacs</h3>
<div class="outline-text-3" id="text-4-7">
<p>

</p>
</div>
<div id="outline-container-sec-4-7-1" class="outline-4">
<h4 id="sec-4-7-1">English Language</h4>
<div class="outline-text-4" id="text-4-7-1">
<p>

</p>

<p>
I type quit fast with lots of misspell and in writing, I don't need to correct every single one when writing, which will stop the flow.  I will do it afterwards in editing, I will press <code>C-,= to move the cursor to next misspelled word, and press =C-.</code> to correcct it, press it again, to correct it to another words.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">check spelling  </span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'text-mode-hook 'flyspell-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mode-hook 'flyspell-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq ispell-dictionary <span class="org-string">"british"</span>
      ispell-extra-args '<span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">TeX mode "-t"</span>
      ispell-silently-savep t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
I need an grammar check to let me know that 
</p>
<pre class="example">
Have you done ...
</pre>
<p>
is wrong, and also tell me why and which is right.  <code>langtool</code> can do be the job, but currently I don't understand how to get it works. 
</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">check grammar </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">langtool</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq langtool-language-tool-jar <span class="org-string">"~/Java/LanguageTool-2.8/languagetool-commandline.jar"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq langtool-mother-tongue <span class="org-string">"en"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">avoid xxx words </span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">artbollocks-mode</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'text-mode-hook 'artbollocks-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq artbollocks-weasel-words-regex
      <span class="org-rainbow-delimiters-depth-2">(</span>concat <span class="org-string">"\\b"</span> <span class="org-rainbow-delimiters-depth-3">(</span>regexp-opt
                     '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"one of the"</span>
                       <span class="org-string">"should"</span>
                       <span class="org-string">"just"</span>
                       <span class="org-string">"sort of"</span>
                       <span class="org-string">"a lot"</span>
                       <span class="org-string">"probably"</span>
                       <span class="org-string">"maybe"</span>
                       <span class="org-string">"perhaps"</span>
                       <span class="org-string">"I think"</span>
                       <span class="org-string">"really"</span>
                       <span class="org-string">"pretty"</span>
                       <span class="org-string">"nice"</span>
                       <span class="org-string">"action"</span>
                       <span class="org-string">"utilize"</span>
                       <span class="org-string">"leverage"</span><span class="org-rainbow-delimiters-depth-4">)</span> t<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-string">"\\b"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>




<span class="org-comment-delimiter">;; </span><span class="org-comment">[2014-12-25 Thu 22:21]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/write-mode</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>hl-sentence-mode<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>variable-pitch-mode<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>nanowrimo-mode<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">word count</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">https://bitbucket.org/gvol/nanowrimo.el</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-wc</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">nanowrimo</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq nanowrimo-today-goal 500<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">[2014-12-23 Tue 22:06]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight sentence</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">https://www.gnu.org/software/emacs/manual/html_node/elisp/Attribute-Functions.html</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">hl-sentence</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'nanowrimo-mode 'hl-sentence-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'hl-sentence-face nil
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">:foreground "black")</span>
                    <span class="org-builtin">:foreground</span> <span class="org-string">"white"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'nanowrimo-mode 'variable-pitch-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-attribute 'variable-pitch nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray40"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-7-2" class="outline-4">
<h4 id="sec-4-7-2">Random Quotes</h4>
<div class="outline-text-4" id="text-4-7-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-22 Thu 23:14]</span></span>
If I run out of idea, and I didn't write anthing for 1 minutes, Emacs will pop a quote that I collected in the echo area.  the random quotes may gives me some inpisration sometimes.  
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defconst</span> <span class="org-variable-name">yt/quotes</span>
  '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"You can't see paradise, if you don't pedal.  - Chicken Run "</span>
    <span class="org-string">"He who who says he can and he who says he can&#8217;t are both usually right &#8213; Confucius"</span>
    <span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Good quotes </span>
<span class="org-doc">   they can be useful for creative writers as well."</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/show-random-quotes</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Show random quotes to minibuffer"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"%s"</span>
           <span class="org-rainbow-delimiters-depth-3">(</span>nth <span class="org-rainbow-delimiters-depth-4">(</span>random <span class="org-rainbow-delimiters-depth-5">(</span>length yt/quotes<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                yt/quotes<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>run-with-idle-timer 60 t 'yt/show-random-quotes<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-7-3" class="outline-4">
<h4 id="sec-4-7-3">Abbreviation</h4>
<div class="outline-text-4" id="text-4-7-3">
<p>
I have been writing in Emacs/org-mode a lot, have been really tired of capitalise I to I, so I use abbrevitation table, 
</p>

<table id="my-text-abbrevs" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">name</th>
<th scope="col" class="left">expand</th>
<th scope="col" class="left">Category</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">i</td>
<td class="left">I</td>
<td class="left">write</td>
</tr>

<tr>
<td class="left">amax</td>
<td class="left">annual maximum</td>
<td class="left">stat</td>
</tr>

<tr>
<td class="left">gmap</td>
<td class="left">google map</td>
<td class="left">website</td>
</tr>

<tr>
<td class="left">mailme</td>
<td class="left">yi.tang.uk@me.com</td>
<td class="left">aboutme</td>
</tr>

<tr>
<td class="left">twitterme</td>
<td class="left">@yi_tang_uk</td>
<td class="left">aboutme</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-text-abbrev-expand-p</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Return t if the abbrev is in a text context, which is: in</span>
<span class="org-doc"> comments and strings only when in a prog-mode derived-mode or</span>
<span class="org-doc"> src block in org-mode, and anywhere else."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>or <span class="org-rainbow-delimiters-depth-4">(</span>derived-mode-p 'prog-mode<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>and <span class="org-rainbow-delimiters-depth-5">(</span>eq major-mode 'org-mode<span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-rainbow-delimiters-depth-5">(</span>org-in-src-block-p 'inside<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>nth 8 <span class="org-rainbow-delimiters-depth-4">(</span>syntax-ppss<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev-table 'my-text-abbrev-table <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Abbrev table for text-only abbrevs. Expands only in comments and strings."</span>
  <span class="org-builtin">:enable-function</span> #'my-text-abbrev-expand-p<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">dolist</span> <span class="org-rainbow-delimiters-depth-2">(</span>table <span class="org-rainbow-delimiters-depth-3">(</span>list text-mode-abbrev-table
                     prog-mode-abbrev-table<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>abbrev-table-put table
                    <span class="org-builtin">:parents</span> <span class="org-rainbow-delimiters-depth-3">(</span>list my-text-abbrev-table<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Bug fix for python and lisp modes who's abbrev tables aren't set up correctly:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(eval-after-load "python"</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(abbrev-table-put python-mode-abbrev-table</span>
<span class="org-comment-delimiter">;;                     </span><span class="org-comment">:parents (list my-text-abbrev-table</span>
<span class="org-comment-delimiter">;;                                    </span><span class="org-comment">python-mode-skeleton-abbrev-table)))</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(eval-after-load "lisp-mode"</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(abbrev-table-put lisp-mode-abbrev-table</span>
<span class="org-comment-delimiter">;;                     </span><span class="org-comment">:parents (list my-text-abbrev-table)))</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Our only expansion, so far...</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-abbrev my-text-abbrev-table "i" "I" nil :system t)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-text-abbrev-table-init</span> <span class="org-rainbow-delimiters-depth-2">(</span>abbrevs-org-list<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Parse 'name: expansion' pairs from an org list and insert into abbrev table."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Creating text-abbrev table..."</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">dolist</span> <span class="org-rainbow-delimiters-depth-3">(</span>abbrev abbrevs-org-list<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>name <span class="org-rainbow-delimiters-depth-6">(</span>nth 0 abbrev<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>expansion <span class="org-rainbow-delimiters-depth-6">(</span>nth 1 abbrev<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(print (cons name expansion))</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>define-abbrev my-text-abbrev-table name expansion nil <span class="org-builtin">:system</span> t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>my-text-abbrev-table-init my-text-abbrevs<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8">Org mode</h3>
<div class="outline-text-3" id="text-4-8">
<p>
I started to learn Emacs by reading Bernt Hansen's  <a href="http://doc.norang.ca/org-mode.html">Org Mode - Organize Your Life In Plain Text!</a>
</p>
</div>
<div id="outline-container-sec-4-8-1" class="outline-4">
<h4 id="sec-4-8-1">Bernt Hansen's Setting</h4>
<div class="outline-text-4" id="text-4-8-1">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-habit</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-files '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"~/git/org/"</span> <span class="org-string">"~/git/jbarm"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Standard key bindings</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-string">"\C-c l"</span> 'org-store-link<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-comment-delimiter">;; </span><span class="org-comment">C-c C-l is defualt, </span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-string">"\C-c a"</span> 'org-agenda<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-string">"\C-c b"</span> 'org-iswitchb<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">switch between org files. &lt; helm recentf</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">Custom Key Bindings</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f12&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-agenda<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/org-todo<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;S-f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/widen<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f7&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/set-truncate-lines<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f8&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-cycle-agenda-files<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; &lt;f9&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/show-org-agenda<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; b"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bbdb<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; c"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'calendar<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;f9&gt; f") 'boxquote-insert-file)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; g"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'gnus<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; h"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/hide-other<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; n"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/toggle-next-task-display<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; I"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/punch-in<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; O"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/punch-out<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; o"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/make-org-scratch<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; r"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'boxquote-region<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; s"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/switch-to-scratch<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; t"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/insert-inactive-timestamp<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; T"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/toggle-insert-inactive-timestamp<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; v"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'visible-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; l"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-toggle-link-display<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; SPC"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/clock-in-last-task<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f9&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'previous-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-&lt;f9&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-toggle-inline-images<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x n r"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'narrow-to-region<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f10&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'next-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f11&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-clock-goto<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f11&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-clock-in<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-s-&lt;f12&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/save-then-publish<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c c"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-capture<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/hide-other</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-back-to-heading 'invisible-ok<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>hide-other<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-cycle<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-cycle<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-cycle<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/set-truncate-lines</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Toggle value of truncate-lines and refresh window display."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq truncate-lines <span class="org-rainbow-delimiters-depth-3">(</span>not truncate-lines<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">now refresh window display (an idiom from simple.el):</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>set-window-start <span class="org-rainbow-delimiters-depth-4">(</span>selected-window<span class="org-rainbow-delimiters-depth-4">)</span>
                      <span class="org-rainbow-delimiters-depth-4">(</span>window-start <span class="org-rainbow-delimiters-depth-5">(</span>selected-window<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/make-org-scratch</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"/tmp/publish/scratch.org"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>gnus-make-directory <span class="org-string">"/tmp/publish"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/switch-to-scratch</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>switch-to-buffer <span class="org-string">"*scratch*"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-todo-keywords
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>sequence <span class="org-string">"TODO(t)"</span> <span class="org-string">"NEXT(n)"</span> <span class="org-string">"|"</span> <span class="org-string">"DONE(d)"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>sequence <span class="org-string">"WAITING(w@/!)"</span> <span class="org-string">"HOLD(h@/!)"</span> <span class="org-string">"|"</span> <span class="org-string">"CANCELLED(c@/!)"</span> <span class="org-string">"PHONE"</span> <span class="org-string">"MEETING"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-todo-keyword-faces
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"TODO"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"red"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"NEXT"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"blue"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"DONE"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"forest green"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"WAITING"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"orange"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"HOLD"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"magenta"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"CANCELLED"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"forest green"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"MEETING"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"forest green"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"PHONE"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"forest green"</span> <span class="org-builtin">:weight</span> bold<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-use-fast-todo-selection t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: turn off!, need it. </span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-treat-S-cursor-todo-selection-as-state-change nil<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">BUG</span><span class="org-comment">: need to remove S-&lt;left&gt; and &lt;right&gt; from org key map completely, as it used for moving to window.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">keep todo, done, next (project ongoing), waiting (program running), hold (no process machine), cancel (someone else will do) keyworld .</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-todo-state-tags-triggers
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"CANCELLED"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"CANCELLED"</span> . t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"WAITING"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span> . t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"HOLD"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"HOLD"</span> . t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>done <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"HOLD"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"TODO"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"CANCELLED"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"HOLD"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"NEXT"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"CANCELLED"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"HOLD"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"DONE"</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"WAITING"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"CANCELLED"</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-string">"HOLD"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-directory <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"~/git/jbarm"</span>
                            <span class="org-string">"~/git/org"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">FIXME</span><span class="org-comment">: add ~/git/jbarm folder </span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-default-notes-file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">I use C-c c to start capture mode</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c c"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'org-capture<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">mine modication </span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-capture-templates
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"t"</span> <span class="org-string">"todo"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* TODO %?\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: %? %U %a, what does these means??? %: %c </span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"r"</span> <span class="org-string">"respond"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-comment-delimiter">;; </span><span class="org-comment">"* NEXT Respond to %^{whom} on %^{subject} \n %? \nSCHEDULED: %t\n%U\n" :clock-in t :clock-resume t :immediate-finish t)</span>
               <span class="org-string">"* To %? about :RESPONSE:  \nSCHEDULED: %t\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"n"</span> <span class="org-string">"note"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* %? :NOTE:\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"j"</span> <span class="org-string">"Journal"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file+datetree <span class="org-string">"~/git/org/diary.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* %?\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"m"</span> <span class="org-string">"Meeting"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* MEETING with %? :MEETING:\n%U"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"p"</span> <span class="org-string">"Phone call"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/refile.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* PHONE %? :PHONE:\n%U"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"h"</span> <span class="org-string">"Habit"</span> entry <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/org/habits.org"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"* NEXT %?\n%U\nSCHEDULED: %(format-time-string \"&lt;%Y-%m-%d .+1d/3d&gt;\")\n:PROPERTIES:\n:STYLE: habit\n:REPEAT_TO_STATE: NEXT\n:END:\n"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"l"</span> <span class="org-string">"Ledger entries"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">("ll" "Lloyas" plain (file+olp "~/git/org/refile.org"  "Finance")</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"ll"</span> <span class="org-string">"Lloyas"</span> plain <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/ImportantFiles/ledger"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"%(org-read-date) %^{Payee}\n\tExpenses:%^{Account}\t&#163; %^{Amount}\n\tAssets:Lloyds"</span> <span class="org-builtin">:immediate-finish</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">("lc" "Cash" plain (file+olp "~/git/org/refile.org"  "Finance")</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"lc"</span> <span class="org-string">"Cash"</span> plain <span class="org-rainbow-delimiters-depth-5">(</span>file <span class="org-string">"~/git/ImportantFiles/ledger"</span><span class="org-rainbow-delimiters-depth-5">)</span>
               <span class="org-string">"%(org-read-date) * %^{Payee}\n\tExpenses:%^{Account}\t&#163; %^{Amount}\n\tAssets:Cash"</span> <span class="org-builtin">:immediate-finish</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-comment-delimiter">;; </span><span class="org-comment">Remove empty LOGBOOK drawers on clock out</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(defun bh/remove-empty-drawer-on-clock-out ()</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(save-excursion</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(beginning-of-line 0)</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(org-remove-empty-drawer-at (point))))</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">replaced above by: http://stackoverflow.com/questions/21767471/org-capture-and-time-clocking-misbehaving</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/remove-empty-drawer-on-clock-out</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>beginning-of-line 0<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-remove-empty-drawer-at <span class="org-string">"LOGBOOK"</span> <span class="org-rainbow-delimiters-depth-4">(</span>point<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-clock-out-hook 'bh/remove-empty-drawer-on-clock-out 'append<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Targets include this file and any file contributing to the agenda - up to 9 levels deep</span>

<span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: change this block, use helm completion </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-completion-handler to 'helm)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">actually, the following setting is mimic the helm behavoir, why not we just use helm, instead of making ido helm </span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-refile-targets <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>nil <span class="org-builtin">:maxlevel</span> . 9<span class="org-rainbow-delimiters-depth-4">)</span>
                                 <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-files <span class="org-builtin">:maxlevel</span> . 9<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-completion-handler 'helm<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Use full outline paths for refile targets - we file directly with IDO</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-refile-use-outline-path t<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Targets complete directly with IDO</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-outline-path-complete-in-steps nil<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Allow refile to create parent tasks with confirmation</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-refile-allow-creating-parent-nodes <span class="org-rainbow-delimiters-depth-2">(</span>quote confirm<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;;;; </span><span class="org-comment">Refile settings</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Exclude DONE state tasks from refile targets</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/verify-refile-target</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Exclude todo keywords with a done state from refile targets"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>not <span class="org-rainbow-delimiters-depth-3">(</span>member <span class="org-rainbow-delimiters-depth-4">(</span>nth 2 <span class="org-rainbow-delimiters-depth-5">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> org-done-keywords<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-refile-target-verify-function 'bh/verify-refile-target<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Resume clocking task when emacs is restarted</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-clock-persistence-insinuate<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Show lot of clocking history so it's easy to pick items off the C-F11 list</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-history-length 23<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Resume clocking task on clock-in if the clock is open</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-in-resume t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Change tasks to NEXT when clocking in</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-in-switch-to-state 'bh/clock-in-to-next<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Separate drawers for clocking and logs</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-drawers <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"PROPERTIES"</span> <span class="org-string">"LOGBOOK"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Save clock data and state changes and notes in the LOGBOOK drawer</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-into-drawer t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Sometimes I change tasks I'm clocking quickly - this removes clocked tasks with 0:00 duration</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-out-remove-zero-time-clocks t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Clock out when moving task to a done state</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-out-when-done t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Save the running clock and all clock history when exiting Emacs, load it on startup</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-persist t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Do not prompt to resume an active clock</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-persist-query-resume nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Enable auto clock resolution for finding open clocks</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-auto-clock-resolution <span class="org-rainbow-delimiters-depth-2">(</span>quote when-no-clock-is-running<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Include current clocking task in clock reports</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-report-include-clocking-task t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq bh/keep-clock-running nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-to-next</span> <span class="org-rainbow-delimiters-depth-2">(</span>kw<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Switch a task from TODO to NEXT when clocking in.</span>
<span class="org-doc">Skips capture tasks, projects, and subprojects.</span>
<span class="org-doc">Switch projects and subprojects from NEXT back to TODO"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>and <span class="org-rainbow-delimiters-depth-5">(</span>boundp 'org-capture-mode<span class="org-rainbow-delimiters-depth-5">)</span> org-capture-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>and <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>list <span class="org-string">"TODO"</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>bh/is-task-p<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-string">"NEXT"</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>and <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>list <span class="org-string">"NEXT"</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-string">"TODO"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/find-project-task</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Move point to the parent (project) task if any"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>parent-task <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-back-to-heading 'invisible-ok<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-5">(</span>org-up-heading-safe<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>nth 2 <span class="org-rainbow-delimiters-depth-8">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>setq parent-task <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char parent-task<span class="org-rainbow-delimiters-depth-4">)</span>
      parent-task<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/punch-in</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Start continuous clocking and set the default task to the</span>
<span class="org-doc">selected task.  If no task is selected set the Organization task</span>
<span class="org-doc">as the default task."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq bh/keep-clock-running t<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-comment-delimiter">;;</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">We're in the agenda</span>
      <span class="org-comment-delimiter">;;</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>marker <span class="org-rainbow-delimiters-depth-6">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
             <span class="org-rainbow-delimiters-depth-5">(</span>tags <span class="org-rainbow-delimiters-depth-6">(</span>org-with-point-at marker <span class="org-rainbow-delimiters-depth-7">(</span>org-get-tags-at<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>and <span class="org-rainbow-delimiters-depth-6">(</span>eq arg 4<span class="org-rainbow-delimiters-depth-6">)</span> tags<span class="org-rainbow-delimiters-depth-5">)</span>
            <span class="org-rainbow-delimiters-depth-5">(</span>org-agenda-clock-in '<span class="org-rainbow-delimiters-depth-6">(</span>16<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>bh/clock-in-organization-task-as-default<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">We are not in the agenda</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-restriction</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>widen<span class="org-rainbow-delimiters-depth-4">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Find the tags on the current task</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>and <span class="org-rainbow-delimiters-depth-6">(</span>equal major-mode 'org-mode<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>not <span class="org-rainbow-delimiters-depth-7">(</span>org-before-first-heading-p<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>eq arg 4<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>org-clock-in '<span class="org-rainbow-delimiters-depth-6">(</span>16<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>bh/clock-in-organization-task-as-default<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/punch-out</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq bh/keep-clock-running nil<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-clock-is-active<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-clock-out<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-agenda-remove-restriction-lock<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-default-task</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-with-point-at org-clock-default-task
      <span class="org-rainbow-delimiters-depth-4">(</span>org-clock-in<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-parent-task</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Move point to the parent (project) task if any and clock in"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>parent-task<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-restriction</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>widen<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>not parent-task<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-up-heading-safe<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>nth 2 <span class="org-rainbow-delimiters-depth-9">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>setq parent-task <span class="org-rainbow-delimiters-depth-8">(</span>point<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> parent-task
            <span class="org-rainbow-delimiters-depth-6">(</span>org-with-point-at parent-task
              <span class="org-rainbow-delimiters-depth-7">(</span>org-clock-in<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> bh/keep-clock-running
            <span class="org-rainbow-delimiters-depth-7">(</span>bh/clock-in-default-task<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/organization-task-id</span> <span class="org-string">"eb155a82-92b2-4f25-a3c6-0304591af2f9"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">BUG</span><span class="org-comment">: british english, change to a simpler id. </span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-organization-task-as-default</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-3">(</span>org-id-find bh/organization-task-id 'marker<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-clock-in '<span class="org-rainbow-delimiters-depth-4">(</span>16<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-out-maybe</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-3">(</span>and bh/keep-clock-running
             <span class="org-rainbow-delimiters-depth-4">(</span>not org-clock-clocking-in<span class="org-rainbow-delimiters-depth-4">)</span>
             <span class="org-rainbow-delimiters-depth-4">(</span>marker-buffer org-clock-default-task<span class="org-rainbow-delimiters-depth-4">)</span>
             <span class="org-rainbow-delimiters-depth-4">(</span>not org-clock-resolving-clocks-due-to-idleness<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/clock-in-parent-task<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-clock-out-hook 'bh/clock-out-maybe 'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-id</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-task-by-id</span> <span class="org-rainbow-delimiters-depth-2">(</span>id<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Clock in a task by id"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-3">(</span>org-id-find id 'marker<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-clock-in nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/clock-in-last-task</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Clock in the interrupted task if there is one</span>
<span class="org-doc">Skip the default task and get the next one.</span>
<span class="org-doc">A prefix arg forces clock in of the default task."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>clock-in-to-task
         <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">cond</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>eq arg 4<span class="org-rainbow-delimiters-depth-7">)</span> org-clock-default-task<span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>and <span class="org-rainbow-delimiters-depth-8">(</span>org-clock-is-active<span class="org-rainbow-delimiters-depth-8">)</span>
                <span class="org-rainbow-delimiters-depth-8">(</span>equal org-clock-default-task <span class="org-rainbow-delimiters-depth-9">(</span>cadr org-clock-history<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
           <span class="org-rainbow-delimiters-depth-7">(</span>caddr org-clock-history<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>org-clock-is-active<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>cadr org-clock-history<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>equal org-clock-default-task <span class="org-rainbow-delimiters-depth-8">(</span>car org-clock-history<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>cadr org-clock-history<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>t <span class="org-rainbow-delimiters-depth-7">(</span>car org-clock-history<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-with-point-at clock-in-to-task
      <span class="org-rainbow-delimiters-depth-4">(</span>org-clock-in nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-time-stamp-rounding-minutes <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span>1 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">Y: default is 5</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-clock-consistency-checks
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:max-duration</span> <span class="org-string">"4:00"</span>
                            <span class="org-builtin">:min-duration</span> 0
                            <span class="org-builtin">:max-gap</span> 0
                            <span class="org-builtin">:gap-ok-around</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"4:00"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Sometimes I change tasks I'm clocking quickly - this removes clocked tasks with 0:00 duration</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-out-remove-zero-time-clocks t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Agenda clock report parameters</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-clockreport-parameter-plist
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-builtin">:link</span> t <span class="org-builtin">:maxlevel</span> 5 <span class="org-builtin">:fileskip0</span> t <span class="org-builtin">:compact</span> t <span class="org-builtin">:narrow</span> 80<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Set default column view headings: Task Effort Clock_Summary</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-columns-default-format <span class="org-string">"%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-columns-default-format "%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM %20Mood")</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">global Effort estimate values</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">global STYLE property values for completion</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-global-properties <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Effort_ALL"</span> . <span class="org-string">"0:15 0:30 0:45 1:00 2:00 3:00 4:00 5:00 6:00 0:00"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                    <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"STYLE_ALL"</span> . <span class="org-string">"habit"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Agenda log mode items to display (closed and state changes by default)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-log-mode-items (quote (closed state)))</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-log-mode-items <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span>clock state<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Tags with fast selection keys</span>
<span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: have @home, @office, @library, @coffe, @cinema </span>
<span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: have @running, @struech, </span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-tag-alist <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-builtin">:startgroup</span><span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"@library"</span> . ?L<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"@office"</span> . ?O<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"@home"</span> . ?H<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"@coffeeshop"</span> . ?C<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-builtin">:endgroup</span><span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"WAITING"</span> . ?w<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"HOLD"</span> . ?h<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"PERSONAL"</span> . ?P<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"WORK"</span> . ?W<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"FARM"</span> . ?F<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"NOTE"</span> . ?n<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"CANCELLED"</span> . ?c<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Allow setting single tags without the menu</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-fast-tag-selection-single-key <span class="org-rainbow-delimiters-depth-2">(</span>quote expert<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">For tag searches ignore tasks with scheduled and deadline dates</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-tags-todo-honor-ignore-options t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'bbdb)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'bbdb-com)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; p"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/phone-call<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Phone capture template handling with BBDB lookup</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Adapted from code by Gregory J. Grubbs</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/phone-call</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Return name and company info for caller from bbdb lookup"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-3">(</span>name rec caller<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq name <span class="org-rainbow-delimiters-depth-4">(</span>completing-read <span class="org-string">"Who is calling? "</span>
                                <span class="org-rainbow-delimiters-depth-5">(</span>bbdb-hashtable<span class="org-rainbow-delimiters-depth-5">)</span>
                                'bbdb-completion-predicate
                                'confirm<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; <span class="org-rainbow-delimiters-depth-5">(</span>length name<span class="org-rainbow-delimiters-depth-5">)</span> 0<span class="org-rainbow-delimiters-depth-4">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Something was supplied - look it up in bbdb</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq rec
            <span class="org-rainbow-delimiters-depth-5">(</span>or <span class="org-rainbow-delimiters-depth-6">(</span>first
                 <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>bbdb-search <span class="org-rainbow-delimiters-depth-9">(</span>bbdb-records<span class="org-rainbow-delimiters-depth-9">)</span> name nil nil<span class="org-rainbow-delimiters-depth-8">)</span>
                     <span class="org-rainbow-delimiters-depth-8">(</span>bbdb-search <span class="org-rainbow-delimiters-depth-9">(</span>bbdb-records<span class="org-rainbow-delimiters-depth-9">)</span> nil name nil<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                name<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Build the bbdb link if we have a bbdb record, otherwise just return the name</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq caller <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and rec <span class="org-rainbow-delimiters-depth-7">(</span>vectorp rec<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                        <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>name <span class="org-rainbow-delimiters-depth-9">(</span>bbdb-record-name rec<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                              <span class="org-rainbow-delimiters-depth-8">(</span>company <span class="org-rainbow-delimiters-depth-9">(</span>bbdb-record-company rec<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                          <span class="org-rainbow-delimiters-depth-7">(</span>concat <span class="org-string">"[[bbdb:"</span>
                                  name <span class="org-string">"]["</span>
                                  name <span class="org-string">"]]"</span>
                                  <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">when</span> company
                                    <span class="org-rainbow-delimiters-depth-9">(</span>concat <span class="org-string">" - "</span> company<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                       <span class="org-rainbow-delimiters-depth-5">(</span>rec<span class="org-rainbow-delimiters-depth-5">)</span>
                       <span class="org-rainbow-delimiters-depth-5">(</span>t <span class="org-string">"NameOfCaller"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>insert caller<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-span 'day<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-stuck-projects <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">""</span> nil nil <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-project-p</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Any task with a todo keyword subtask"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>has-subtask<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>is-a-task <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>nth 2 <span class="org-rainbow-delimiters-depth-8">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-excursion</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>not has-subtask<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>&lt; <span class="org-rainbow-delimiters-depth-8">(</span>point<span class="org-rainbow-delimiters-depth-8">)</span> subtree-end<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>re-search-forward <span class="org-string">"^\*+ "</span> subtree-end t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-8">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>setq has-subtask t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>and is-a-task has-subtask<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-project-subtree-p</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Any task with a todo keyword that is in a project subtree.</span>
<span class="org-doc">Callers of this function already widen the buffer view."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>task <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-6">(</span>org-back-to-heading 'invisible-ok<span class="org-rainbow-delimiters-depth-6">)</span>
                              <span class="org-rainbow-delimiters-depth-6">(</span>point<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>bh/find-project-task<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>equal <span class="org-rainbow-delimiters-depth-6">(</span>point<span class="org-rainbow-delimiters-depth-6">)</span> task<span class="org-rainbow-delimiters-depth-5">)</span>
          nil
        t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-task-p</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Any task with a todo keyword and no subtask"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>has-subtask<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>is-a-task <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>nth 2 <span class="org-rainbow-delimiters-depth-8">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-excursion</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>not has-subtask<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>&lt; <span class="org-rainbow-delimiters-depth-8">(</span>point<span class="org-rainbow-delimiters-depth-8">)</span> subtree-end<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>re-search-forward <span class="org-string">"^\*+ "</span> subtree-end t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-8">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>setq has-subtask t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>and is-a-task <span class="org-rainbow-delimiters-depth-5">(</span>not has-subtask<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-subproject-p</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Any task which is a subtask of another project"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>is-subproject<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>is-a-task <span class="org-rainbow-delimiters-depth-5">(</span>member <span class="org-rainbow-delimiters-depth-6">(</span>nth 2 <span class="org-rainbow-delimiters-depth-7">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-5">(</span>and <span class="org-rainbow-delimiters-depth-6">(</span>not is-subproject<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>org-up-heading-safe<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>nth 2 <span class="org-rainbow-delimiters-depth-8">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>setq is-subproject t<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>and is-a-task is-subproject<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/list-sublevels-for-projects-indented</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Set org-tags-match-list-sublevels so when restricted to a subtree we list all subtasks.</span>
<span class="org-doc">  This is normally used by skipping functions where this variable is already local to the agenda."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>marker-buffer org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>setq org-tags-match-list-sublevels 'indented<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/list-sublevels-for-projects</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Set org-tags-match-list-sublevels so when restricted to a subtree we list all subtasks.</span>
<span class="org-doc">  This is normally used by skipping functions where this variable is already local to the agenda."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>marker-buffer org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>setq org-tags-match-list-sublevels t<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/hide-scheduled-and-waiting-next-tasks</span> t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/toggle-next-task-display</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq bh/hide-scheduled-and-waiting-next-tasks <span class="org-rainbow-delimiters-depth-3">(</span>not bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span>  <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"%s WAITING and SCHEDULED NEXT Tasks"</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> bh/hide-scheduled-and-waiting-next-tasks <span class="org-string">"Hide"</span> <span class="org-string">"Show"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-stuck-projects</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are not stuck projects"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>subtree-end <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-9">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                 <span class="org-rainbow-delimiters-depth-7">(</span>has-next <span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span>
              <span class="org-rainbow-delimiters-depth-7">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-7">)</span>
              <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-8">(</span>and <span class="org-rainbow-delimiters-depth-9">(</span>not has-next<span class="org-rainbow-delimiters-depth-9">)</span> <span class="org-rainbow-delimiters-depth-9">(</span>&lt; <span class="org-rainbow-delimiters-depth-1">(</span>point<span class="org-rainbow-delimiters-depth-1">)</span> subtree-end<span class="org-rainbow-delimiters-depth-9">)</span> <span class="org-rainbow-delimiters-depth-9">(</span>re-search-forward <span class="org-string">"^\\*+ NEXT "</span> subtree-end t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-9">(</span>member <span class="org-string">"WAITING"</span> <span class="org-rainbow-delimiters-depth-1">(</span>org-get-tags-at<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span>
                  <span class="org-rainbow-delimiters-depth-9">(</span>setq has-next t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">if</span> has-next
                nil
              next-headline<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">a stuck project, has subtasks but no next task</span>
        nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-non-stuck-projects</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are not stuck projects"</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(bh/list-sublevels-for-projects-indented)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>subtree-end <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-9">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                 <span class="org-rainbow-delimiters-depth-7">(</span>has-next <span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span>
              <span class="org-rainbow-delimiters-depth-7">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-7">)</span>
              <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-8">(</span>and <span class="org-rainbow-delimiters-depth-9">(</span>not has-next<span class="org-rainbow-delimiters-depth-9">)</span> <span class="org-rainbow-delimiters-depth-9">(</span>&lt; <span class="org-rainbow-delimiters-depth-1">(</span>point<span class="org-rainbow-delimiters-depth-1">)</span> subtree-end<span class="org-rainbow-delimiters-depth-9">)</span> <span class="org-rainbow-delimiters-depth-9">(</span>re-search-forward <span class="org-string">"^\\*+ NEXT "</span> subtree-end t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-9">(</span>member <span class="org-string">"WAITING"</span> <span class="org-rainbow-delimiters-depth-1">(</span>org-get-tags-at<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span>
                  <span class="org-rainbow-delimiters-depth-9">(</span>setq has-next t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">if</span> has-next
                next-headline
              nil<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">a stuck project, has subtasks but no next task</span>
        next-headline<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-non-projects</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are not projects"</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(bh/list-sublevels-for-projects-indented)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-4">(</span>bh/skip-non-stuck-projects<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-restriction</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>widen<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>subtree-end <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-8">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">cond</span>
           <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-7">)</span>
            nil<span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>and <span class="org-rainbow-delimiters-depth-8">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>not <span class="org-rainbow-delimiters-depth-9">(</span>bh/is-task-p<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
            nil<span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>t
            subtree-end<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-4">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-project-trees-and-habits</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are projects"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-projects-and-habits-and-single-tasks</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are projects, tasks that are habits, single non-project tasks"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and bh/hide-scheduled-and-waiting-next-tasks
             <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-string">"WAITING"</span> <span class="org-rainbow-delimiters-depth-8">(</span>org-get-tags-at<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>bh/is-task-p<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>not <span class="org-rainbow-delimiters-depth-8">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-project-tasks-maybe</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Show tasks related to the current restriction.</span>
<span class="org-doc">When restricted to a project, skip project and sub project tasks, habits, NEXT tasks, and loose tasks.</span>
<span class="org-doc">When not restricted, skip project and sub-project tasks, habits, and project related tasks."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>limit-to-project <span class="org-rainbow-delimiters-depth-6">(</span>marker-buffer org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>not limit-to-project<span class="org-rainbow-delimiters-depth-7">)</span>
             <span class="org-rainbow-delimiters-depth-7">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and limit-to-project
             <span class="org-rainbow-delimiters-depth-7">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-7">)</span>
             <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>list <span class="org-string">"NEXT"</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-project-tasks</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Show non-project tasks.</span>
<span class="org-doc">Skip project and sub-project tasks, habits, and project related tasks."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-non-project-tasks</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Show project tasks.</span>
<span class="org-doc">Skip project and sub-project tasks, habits, and loose non-project tasks."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-7">)</span>
             <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>list <span class="org-string">"NEXT"</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>not <span class="org-rainbow-delimiters-depth-7">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-projects-and-habits</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are projects and tasks that are habits"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">cond</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-is-habit-p<span class="org-rainbow-delimiters-depth-6">)</span>
        subtree-end<span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>t
        nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-non-subprojects</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are not projects"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>next-headline <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-6">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>bh/is-subproject-p<span class="org-rainbow-delimiters-depth-4">)</span>
        nil
      next-headline<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-archive-mark-done nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-archive-location <span class="org-string">"%s_archive::* Archived Tasks"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/skip-non-archivable-tasks</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Skip trees that are not available for archiving"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Consider only tasks with done todo headings as archivable candidates</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next-headline <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>outline-next-heading<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>subtree-end <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">save-excursion</span> <span class="org-rainbow-delimiters-depth-7">(</span>org-end-of-subtree t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>member <span class="org-rainbow-delimiters-depth-6">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-6">)</span> org-todo-keywords-1<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-6">(</span>member <span class="org-rainbow-delimiters-depth-7">(</span>org-get-todo-state<span class="org-rainbow-delimiters-depth-7">)</span> org-done-keywords<span class="org-rainbow-delimiters-depth-6">)</span>
              <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>daynr <span class="org-rainbow-delimiters-depth-9">(</span>string-to-int <span class="org-rainbow-delimiters-depth-1">(</span>format-time-string <span class="org-string">"%d"</span> <span class="org-rainbow-delimiters-depth-2">(</span>current-time<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                     <span class="org-rainbow-delimiters-depth-8">(</span>a-month-ago <span class="org-rainbow-delimiters-depth-9">(</span>* 60 60 24 7 <span class="org-rainbow-delimiters-depth-1">(</span>+ daynr 1<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                     <span class="org-rainbow-delimiters-depth-8">(</span>last-month <span class="org-rainbow-delimiters-depth-9">(</span>format-time-string <span class="org-string">"%Y-%m-"</span> <span class="org-rainbow-delimiters-depth-1">(</span>time-subtract <span class="org-rainbow-delimiters-depth-2">(</span>current-time<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>seconds-to-time a-month-ago<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                     <span class="org-rainbow-delimiters-depth-8">(</span>this-month <span class="org-rainbow-delimiters-depth-9">(</span>format-time-string <span class="org-string">"%Y-%m-"</span> <span class="org-rainbow-delimiters-depth-1">(</span>current-time<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                     <span class="org-rainbow-delimiters-depth-8">(</span>subtree-is-current <span class="org-rainbow-delimiters-depth-9">(</span><span class="org-keyword">save-excursion</span>
                                           <span class="org-rainbow-delimiters-depth-1">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-1">)</span>
                                           <span class="org-rainbow-delimiters-depth-1">(</span>and <span class="org-rainbow-delimiters-depth-2">(</span>&lt; <span class="org-rainbow-delimiters-depth-3">(</span>point<span class="org-rainbow-delimiters-depth-3">)</span> subtree-end<span class="org-rainbow-delimiters-depth-2">)</span>
                                                <span class="org-rainbow-delimiters-depth-2">(</span>re-search-forward <span class="org-rainbow-delimiters-depth-3">(</span>concat last-month <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">"</span> this-month<span class="org-rainbow-delimiters-depth-3">)</span> subtree-end t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">if</span> subtree-is-current
                    subtree-end <span class="org-comment-delimiter">; </span><span class="org-comment">Has a date in this month or last month, skip it</span>
                  nil<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>  <span class="org-comment-delimiter">; </span><span class="org-comment">available to archive</span>
            <span class="org-rainbow-delimiters-depth-6">(</span>or subtree-end <span class="org-rainbow-delimiters-depth-7">(</span>point-max<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        next-headline<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-alphabetical-lists t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Explicitly load required exporters</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ox-html</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ox-latex</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ox-ascii</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">ox-md</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-plantuml-jar-path <span class="org-string">"~/java/plantuml.jar"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: change the location.. </span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-babel-after-execute-hook 'bh/display-inline-images 'append<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Make babel results blocks lowercase</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-babel-results-keyword <span class="org-string">"results"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/display-inline-images</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">condition-case</span> nil
      <span class="org-rainbow-delimiters-depth-3">(</span>org-display-inline-images<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-warning">error</span> nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>org-babel-do-load-languages
 <span class="org-rainbow-delimiters-depth-2">(</span>quote org-babel-load-languages<span class="org-rainbow-delimiters-depth-2">)</span>
 <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>emacs-lisp . t<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: simplifiy this list </span>
                 <span class="org-rainbow-delimiters-depth-4">(</span>R . t<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>sh . t<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>ledger . t<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>org . t<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>plantuml . t<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>latex . t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-rainbow-delimiters-depth-1">(</span>setq org-confirm-babel-evaluate nil<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Use fundamental mode when editing plantuml blocks with C-c '</span>
<span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: what is fundamental mode?? </span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'org-src-lang-modes <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"plantuml"</span> . fundamental<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


                                        <span class="org-comment-delimiter">; </span><span class="org-comment">I'm lazy and don't want to remember the name of the project to publish when I modify</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">a file that is part of a project.  So this function saves the file, and publishes</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">the project that includes this file</span>
                                        <span class="org-comment-delimiter">;</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">It's bound to C-S-F12 so I just edit and hit C-S-F12 when I'm done and move on to the next thing</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/save-then-publish</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">&amp;optional</span> force<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"P"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>save-buffer<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-save-all-org-buffers<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>org-html-head-extra<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-html-validation-link <span class="org-string">"&lt;a href=\"http://validator.w3.org/check?uri=referer\"&gt;Validate XHTML 1.0&lt;/a&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-publish-current-project force<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-s-&lt;f12&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/save-then-publish<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-latex-listings t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-xml-declaration <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"html"</span> . <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                       <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"was-html"</span> . <span class="org-string">"&lt;?xml version=\"1.0\" encoding=\"%s\"?&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                       <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"php"</span> . <span class="org-string">"&lt;?php echo \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"%s\\\" ?&gt;\"; ?&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-allow-BIND t<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Erase all reminders and rebuilt reminders for today from the agenda</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/org-agenda-to-appt</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq appt-time-msg-list nil<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq appt-display-format 'window<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;; </span><span class="org-warning">YT</span><span class="org-comment">: show notification in separate window</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-agenda-to-appt<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Rebuild the reminders everytime the agenda is displayed</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-finalize-agenda-hook 'bh/org-agenda-to-appt 'append<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">This is at the end of my .emacs - so appointments are set up when Emacs starts</span>
<span class="org-rainbow-delimiters-depth-1">(</span>bh/org-agenda-to-appt<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Activate appointments so we get notifications</span>
<span class="org-rainbow-delimiters-depth-1">(</span>appt-activate t<span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">If we leave Emacs running overnight - reset the appointments one minute after midnight</span>
<span class="org-rainbow-delimiters-depth-1">(</span>run-at-time <span class="org-string">"24:01"</span> nil 'bh/org-agenda-to-appt<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Enable abbrev-mode</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>abbrev-mode 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Skeletons</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">sblk - Generic block #+begin_FOO .. #+end_FOO</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block</span>
  <span class="org-doc">"Insert an org block, querying for type."</span>
  <span class="org-string">"Type: "</span>
  <span class="org-string">"#+begin_"</span> str <span class="org-string">"\n"</span>
  _ - \n
  <span class="org-string">"#+end_"</span> str <span class="org-string">"\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sblk"</span> <span class="org-string">""</span> 'skel-org-block<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">splantuml - PlantUML Source block</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-plantuml</span>
  <span class="org-doc">"Insert a org plantuml block, querying for filename."</span>
  <span class="org-string">"File (no extension): "</span>
  <span class="org-string">"#+begin_src plantuml :file "</span> str <span class="org-string">".png :cache yes\n"</span>
  _ - \n
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"splantuml"</span> <span class="org-string">""</span> 'skel-org-block-plantuml<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-plantuml-activity</span>
  <span class="org-doc">"Insert a org plantuml block, querying for filename."</span>
  <span class="org-string">"File (no extension): "</span>
  <span class="org-string">"#+begin_src plantuml :file "</span> str <span class="org-string">"-act.png :cache yes :tangle "</span> str <span class="org-string">"-act.txt\n"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>bh/plantuml-reset-counters<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-string">"@startuml\n"</span>
  <span class="org-string">"skinparam activity {\n"</span>
  <span class="org-string">"BackgroundColor&lt;&lt;New&gt;&gt; Cyan\n"</span>
  <span class="org-string">"}\n\n"</span>
  <span class="org-string">"title "</span> str <span class="org-string">" - \n"</span>
  <span class="org-string">"note left: "</span> str <span class="org-string">"\n"</span>
  <span class="org-string">"(*) --&gt; \""</span> str <span class="org-string">"\"\n"</span>
  <span class="org-string">"--&gt; (*)\n"</span>
  _ - \n
  <span class="org-string">"@enduml\n"</span>
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/plantuml-if-count</span> 0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/plantuml-if</span> <span class="org-rainbow-delimiters-depth-2">()</span> 
  <span class="org-rainbow-delimiters-depth-2">(</span>incf bh/plantuml-if-count<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>number-to-string bh/plantuml-if-count<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/plantuml-loop-count</span> 0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/plantuml-loop</span> <span class="org-rainbow-delimiters-depth-2">()</span> 
  <span class="org-rainbow-delimiters-depth-2">(</span>incf bh/plantuml-loop-count<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>number-to-string bh/plantuml-loop-count<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/plantuml-reset-counters</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq bh/plantuml-if-count 0
        bh/plantuml-loop-count 0<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sact"</span> <span class="org-string">""</span> 'skel-org-block-plantuml-activity<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-plantuml-activity-if</span>
  <span class="org-doc">"Insert a org plantuml block activity if statement"</span>
  <span class="org-string">""</span> 
  <span class="org-string">"if \"\" then\n"</span>
  <span class="org-string">"  -&gt; [condition] ==IF"</span> <span class="org-rainbow-delimiters-depth-2">(</span>setq ifn <span class="org-rainbow-delimiters-depth-3">(</span>bh/plantuml-if<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-string">"==\n"</span>
  <span class="org-string">"  --&gt; ==IF"</span> ifn <span class="org-string">"M1==\n"</span>
  <span class="org-string">"  -left-&gt; ==IF"</span> ifn <span class="org-string">"M2==\n"</span>
  <span class="org-string">"else\n"</span>
  <span class="org-string">"end if\n"</span>
  <span class="org-string">"--&gt; ==IF"</span> ifn <span class="org-string">"M2=="</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sif"</span> <span class="org-string">""</span> 'skel-org-block-plantuml-activity-if<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-plantuml-activity-for</span>
  <span class="org-doc">"Insert a org plantuml block activity for statement"</span>
  <span class="org-string">"Loop for each: "</span> 
  <span class="org-string">"--&gt; ==LOOP"</span> <span class="org-rainbow-delimiters-depth-2">(</span>setq loopn <span class="org-rainbow-delimiters-depth-3">(</span>bh/plantuml-loop<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-string">"==\n"</span>
  <span class="org-string">"note left: Loop"</span> loopn <span class="org-string">": For each "</span> str <span class="org-string">"\n"</span>
  <span class="org-string">"--&gt; ==ENDLOOP"</span> loopn <span class="org-string">"==\n"</span>
  <span class="org-string">"note left: Loop"</span> loopn <span class="org-string">": End for each "</span> str <span class="org-string">"\n"</span> <span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sfor"</span> <span class="org-string">""</span> 'skel-org-block-plantuml-activity-for<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-plantuml-sequence</span>
  <span class="org-doc">"Insert a org plantuml activity diagram block, querying for filename."</span>
  <span class="org-string">"File appends (no extension): "</span>
  <span class="org-string">"#+begin_src plantuml :file "</span> str <span class="org-string">"-seq.png :cache yes :tangle "</span> str <span class="org-string">"-seq.txt\n"</span>
  <span class="org-string">"@startuml\n"</span>
  <span class="org-string">"title "</span> str <span class="org-string">" - \n"</span>
  <span class="org-string">"actor CSR as \"Customer Service Representative\"\n"</span>
  <span class="org-string">"participant CSMO as \"CSM Online\"\n"</span>
  <span class="org-string">"participant CSMU as \"CSM Unix\"\n"</span>
  <span class="org-string">"participant NRIS\n"</span>
  <span class="org-string">"actor Customer"</span>
  _ - \n
  <span class="org-string">"@enduml\n"</span>
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sseq"</span> <span class="org-string">""</span> 'skel-org-block-plantuml-sequence<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">sdot - Graphviz DOT block</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-dot</span>
  <span class="org-doc">"Insert a org graphviz dot block, querying for filename."</span>
  <span class="org-string">"File (no extension): "</span>
  <span class="org-string">"#+begin_src dot :file "</span> str <span class="org-string">".png :cache yes :cmdline -Kdot -Tpng\n"</span>
  <span class="org-string">"graph G {\n"</span>
  _ - \n
  <span class="org-string">"}\n"</span>
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sdot"</span> <span class="org-string">""</span> 'skel-org-block-dot<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">sditaa - Ditaa source block</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-ditaa</span>
  <span class="org-doc">"Insert a org ditaa block, querying for filename."</span>
  <span class="org-string">"File (no extension): "</span>
  <span class="org-string">"#+begin_src ditaa :file "</span> str <span class="org-string">".png :cache yes\n"</span>
  _ - \n
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"sditaa"</span> <span class="org-string">""</span> 'skel-org-block-ditaa<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">selisp - Emacs Lisp source block</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-skeleton</span> <span class="org-function-name">skel-org-block-elisp</span>
  <span class="org-doc">"Insert a org emacs-lisp block"</span>
  <span class="org-string">""</span>
  <span class="org-string">"#+begin_src emacs-lisp\n"</span>
  _ - \n
  <span class="org-string">"#+end_src\n"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>define-abbrev org-mode-abbrev-table <span class="org-string">"selisp"</span> <span class="org-string">""</span> 'skel-org-block-elisp<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/org-todo<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/org-todo</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal arg 4<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-restriction</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-show-todo-tree nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-show-todo-tree nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;S-f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'bh/widen<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/widen</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">progn</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-remove-restriction-lock<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> org-agenda-sticky
          <span class="org-rainbow-delimiters-depth-5">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"W"</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">()</span> <span class="org-rainbow-delimiters-depth-5">(</span>interactive<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>setq bh/hide-scheduled-and-waiting-next-tasks t<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>bh/widen<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/restrict-to-file-or-follow</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Set agenda restriction to 'file or with argument invoke follow mode.</span>
<span class="org-doc">I don't use follow mode very often but I restrict to file all the time</span>
<span class="org-doc">so change the default 'F' binding in the agenda to allow both"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal arg 4<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>org-agenda-follow-mode<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>widen<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/set-agenda-restriction-lock 4<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>beginning-of-buffer<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"F"</span> 'bh/restrict-to-file-or-follow<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-to-org-subtree</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>widen<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-narrow-to-subtree<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-restriction</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>org-agenda-set-restriction-lock<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-to-subtree</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">progn</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-5">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> org-agenda-sticky
          <span class="org-rainbow-delimiters-depth-5">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"N"</span> 'bh/narrow-to-subtree<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-up-one-org-level</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>widen<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>outline-up-heading 1 'invisible-ok<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/get-pom-from-agenda-restriction-or-point</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>or <span class="org-rainbow-delimiters-depth-3">(</span>and <span class="org-rainbow-delimiters-depth-4">(</span>marker-position org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-4">)</span> org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>and <span class="org-rainbow-delimiters-depth-4">(</span>equal major-mode 'org-mode<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>point<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      org-clock-marker<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-up-one-level</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">progn</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-5">(</span>bh/get-pom-from-agenda-restriction-or-point<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>bh/narrow-up-one-org-level<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-up-one-org-level<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"U"</span> 'bh/narrow-up-one-level<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-to-org-project</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>widen<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/find-project-task<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/narrow-to-project</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">progn</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-5">(</span>bh/get-pom-from-agenda-restriction-or-point<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>bh/narrow-to-org-project<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">save-excursion</span>
            <span class="org-rainbow-delimiters-depth-6">(</span>bh/find-project-task<span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span>org-agenda-set-restriction-lock<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>beginning-of-buffer<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>bh/narrow-to-org-project<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-restriction</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-set-restriction-lock<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"P"</span> 'bh/narrow-to-project<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/project-list</span> nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/view-next-project</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span>num-project-left current-project<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-4">(</span>marker-position org-agenda-restrict-begin<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char <span class="org-rainbow-delimiters-depth-5">(</span>point-min<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Clear all of the existing markers on the list</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">while</span> bh/project-list
        <span class="org-rainbow-delimiters-depth-5">(</span>set-marker <span class="org-rainbow-delimiters-depth-6">(</span>pop bh/project-list<span class="org-rainbow-delimiters-depth-6">)</span> nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>re-search-forward <span class="org-string">"Tasks to Refile"</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>forward-visible-line 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Build a new project marker list</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">unless</span> bh/project-list
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-5">(</span>&lt; <span class="org-rainbow-delimiters-depth-6">(</span>point<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>point-max<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>&lt; <span class="org-rainbow-delimiters-depth-8">(</span>point<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>point-max<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>or <span class="org-rainbow-delimiters-depth-8">(</span>not <span class="org-rainbow-delimiters-depth-9">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                        <span class="org-rainbow-delimiters-depth-8">(</span>org-with-point-at <span class="org-rainbow-delimiters-depth-9">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-9">)</span>
                          <span class="org-rainbow-delimiters-depth-9">(</span>or <span class="org-rainbow-delimiters-depth-1">(</span>not <span class="org-rainbow-delimiters-depth-2">(</span>bh/is-project-p<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
                              <span class="org-rainbow-delimiters-depth-1">(</span>bh/is-project-subtree-p<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>forward-visible-line 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-6">(</span>&lt; <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>point-max<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>add-to-list 'bh/project-list <span class="org-rainbow-delimiters-depth-7">(</span>copy-marker <span class="org-rainbow-delimiters-depth-8">(</span>org-get-at-bol 'org-hd-marker<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span> 'append<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>forward-visible-line 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Pop off the first marker on the list and display</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>setq current-project <span class="org-rainbow-delimiters-depth-4">(</span>pop bh/project-list<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> current-project
      <span class="org-rainbow-delimiters-depth-4">(</span>org-with-point-at current-project
        <span class="org-rainbow-delimiters-depth-5">(</span>setq bh/hide-scheduled-and-waiting-next-tasks nil<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>bh/narrow-to-project<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Remove the marker</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq current-project nil<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>beginning-of-buffer<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>setq num-projects-left <span class="org-rainbow-delimiters-depth-5">(</span>length bh/project-list<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>&gt; num-projects-left 0<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>message <span class="org-string">"%s projects left to view"</span> num-projects-left<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>beginning-of-buffer<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>setq bh/hide-scheduled-and-waiting-next-tasks t<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-warning">error</span> <span class="org-string">"All projects viewed."</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-rainbow-delimiters-depth-1">(</span>setq org-enforce-todo-dependencies t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-hide-leading-stars nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-startup-indented t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-cycle-separator-lines 0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-blank-before-new-entry <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>heading<span class="org-rainbow-delimiters-depth-4">)</span>
                                         <span class="org-rainbow-delimiters-depth-4">(</span>plain-list-item . auto<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-insert-heading-respect-content nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-reverse-note-order nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-show-following-heading t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-show-hierarchy-above t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-show-siblings <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>default<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-special-ctrl-a/e t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-special-ctrl-k t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-yank-adjusted-subtrees t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-id-method <span class="org-rainbow-delimiters-depth-2">(</span>quote uuidgen<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-deadline-warning-days 30<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-table-export-default-format <span class="org-string">"orgtbl-to-csv"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-link-frame-setup <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>vm . vm-visit-folder<span class="org-rainbow-delimiters-depth-4">)</span>
                                   <span class="org-rainbow-delimiters-depth-4">(</span>gnus . org-gnus-no-new-news<span class="org-rainbow-delimiters-depth-4">)</span>
                                   <span class="org-rainbow-delimiters-depth-4">(</span>file . find-file<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Use the current window for C-c ' source editing</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-src-window-setup 'current-window<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-log-done <span class="org-rainbow-delimiters-depth-2">(</span>quote time<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-log-into-drawer t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-log-state-notes-insert-after-drawers nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clock-sound <span class="org-string">"/usr/local/lib/tngchime.wav"</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Enable habit tracking (and a bunch of other modules)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-modules <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span>org-bbdb
                          org-bibtex
                          org-crypt
                          org-gnus
                          org-id
                          org-info
                          org-jsinfo
                          org-habit
                          org-inlinetask
                          org-irc
                          org-mew
                          org-mhe
                          org-protocol
                          org-rmail
                          org-vm
                          org-wl
                          org-w3m<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">position the habit graph on the agenda to the right of the default</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-habit-graph-column 50<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>run-at-time <span class="org-string">"06:00"</span> 86400 '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>setq org-habit-show-habits t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-auto-revert-mode t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-crypt</span><span class="org-rainbow-delimiters-depth-1">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Encrypt all entries before saving</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-crypt-use-before-save-magic<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-tags-exclude-from-inheritance <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"crypt"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">GPG key to use for encryption</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-crypt-key <span class="org-string">"F0B66B40"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-crypt-disable-auto-save nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-use-speed-commands t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-speed-commands-user <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"0"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"1"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"2"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"3"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"4"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"5"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"6"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"7"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"8"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"9"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>

                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"a"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"d"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"h"</span> . bh/hide-other<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"i"</span> progn
                                       <span class="org-rainbow-delimiters-depth-5">(</span>forward-char 1<span class="org-rainbow-delimiters-depth-5">)</span>
                                       <span class="org-rainbow-delimiters-depth-5">(</span>call-interactively 'org-insert-heading-respect-content<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"k"</span> . org-kill-note-or-show-branches<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"l"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"m"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"q"</span> . bh/show-org-agenda<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"r"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"s"</span> . org-save-all-org-buffers<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"w"</span> . org-refile<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"x"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"y"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"z"</span> . org-add-note<span class="org-rainbow-delimiters-depth-4">)</span>

                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"A"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"B"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"E"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"F"</span> . bh/restrict-to-file-or-follow<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"G"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"H"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"J"</span> . org-clock-goto<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"K"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"L"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"M"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"N"</span> . bh/narrow-to-org-subtree<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"P"</span> . bh/narrow-to-org-project<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Q"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"R"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"S"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"T"</span> . bh/org-todo<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"U"</span> . bh/narrow-up-one-org-level<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"V"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"W"</span> . bh/widen<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"X"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Y"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span>
                                      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Z"</span> . ignore<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/show-org-agenda</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> org-agenda-sticky
      <span class="org-rainbow-delimiters-depth-3">(</span>switch-to-buffer <span class="org-string">"*Org Agenda( )*"</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>switch-to-buffer <span class="org-string">"*Org Agenda*"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>delete-other-windows<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-protocol</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq require-final-newline t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">bh/insert-inactive-timestamp</span> t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/toggle-insert-inactive-timestamp</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq bh/insert-inactive-timestamp <span class="org-rainbow-delimiters-depth-3">(</span>not bh/insert-inactive-timestamp<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Heading timestamps are %s"</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> bh/insert-inactive-timestamp <span class="org-string">"ON"</span> <span class="org-string">"OFF"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/insert-inactive-timestamp</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-insert-time-stamp nil t t nil nil nil<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/insert-heading-inactive-timestamp</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> bh/insert-inactive-timestamp
      <span class="org-rainbow-delimiters-depth-4">(</span>org-return<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>org-cycle<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>bh/insert-inactive-timestamp<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-insert-heading-hook 'bh/insert-heading-inactive-timestamp 'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-with-timestamps nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-return-follows-link t<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/prepare-meeting-notes</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Prepare meeting notes for email</span>
<span class="org-doc">   Take selected region and convert tabs to spaces, mark TODOs with leading &gt;&gt;&gt;, and copy to kill ring for pasting"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span>prefix<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-restriction</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>narrow-to-region <span class="org-rainbow-delimiters-depth-6">(</span>region-beginning<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>region-end<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>untabify <span class="org-rainbow-delimiters-depth-6">(</span>point-min<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>point-max<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>goto-char <span class="org-rainbow-delimiters-depth-6">(</span>point-min<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>re-search-forward <span class="org-string">"^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"> *-\</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">TODO</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">DONE</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">: "</span> <span class="org-rainbow-delimiters-depth-7">(</span>point-max<span class="org-rainbow-delimiters-depth-7">)</span> t<span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>replace-match <span class="org-rainbow-delimiters-depth-7">(</span>concat <span class="org-rainbow-delimiters-depth-8">(</span>make-string <span class="org-rainbow-delimiters-depth-9">(</span>length <span class="org-rainbow-delimiters-depth-1">(</span>match-string 1<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span> ?&gt;<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-string">" "</span> <span class="org-rainbow-delimiters-depth-8">(</span>match-string 2<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-string">": "</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>goto-char <span class="org-rainbow-delimiters-depth-6">(</span>point-min<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>kill-ring-save <span class="org-rainbow-delimiters-depth-6">(</span>point-min<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>point-max<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-remove-highlights-with-change t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'Info-default-directory-list <span class="org-string">"~/git/org-mode/doc"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-read-date-prefer-future 'time<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-list-demote-modify-bullet <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"+"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"*"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"1."</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"1)"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"A)"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"B)"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"a)"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"b)"</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"A."</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"B."</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"a."</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"b."</span> . <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-tags-match-list-sublevels t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-persistent-filter t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-link-mailto-program <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span>compose-mail <span class="org-string">"%a"</span> <span class="org-string">"%s"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Bookmark handling</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;C-f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>interactive<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>bookmark-set <span class="org-string">"SAVED"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>interactive<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>bookmark-jump <span class="org-string">"SAVED"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-skip-additional-timestamps-same-entry t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-table-use-standard-references <span class="org-rainbow-delimiters-depth-2">(</span>quote from<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-file-apps <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>auto-mode . emacs<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"\\.mm\\'"</span> . system<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"\\.x?html?\\'"</span> . system<span class="org-rainbow-delimiters-depth-4">)</span>
                            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"\\.pdf\\'"</span> . system<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Overwrite the current window with the agenda</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-window-setup 'current-window<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-clone-delete-id t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-cycle-include-plain-lists t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-src-fontify-natively t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-structure-template-alist
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"s"</span> <span class="org-string">"#+begin_src ?\n\n#+end_src"</span> <span class="org-string">"&lt;src lang=\"?\"&gt;\n\n&lt;/src&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"R"</span> <span class="org-string">"#+begin_src R\n?\n#+end_src"</span> <span class="org-string">"&lt;src lang=R\"?\"&gt;\n\n&lt;/src&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"e"</span> <span class="org-string">"#+begin_example\n?\n#+end_example"</span> <span class="org-string">"&lt;example&gt;\n?\n&lt;/example&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"q"</span> <span class="org-string">"#+begin_quote\n?\n#+end_quote"</span> <span class="org-string">"&lt;quote&gt;\n?\n&lt;/quote&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"v"</span> <span class="org-string">"#+begin_verse\n?\n#+end_verse"</span> <span class="org-string">"&lt;verse&gt;\n?\n&lt;/verse&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"c"</span> <span class="org-string">"#+begin_center\n?\n#+end_center"</span> <span class="org-string">"&lt;center&gt;\n?\n&lt;/center&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"l"</span> <span class="org-string">"#+begin_latex\n?\n#+end_latex"</span> <span class="org-string">"&lt;literal style=\"latex\"&gt;\n?\n&lt;/literal&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"L"</span> <span class="org-string">"#+latex: "</span> <span class="org-string">"&lt;literal style=\"latex\"&gt;?&lt;/literal&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"h"</span> <span class="org-string">"#+begin_html\n?\n#+end_html"</span> <span class="org-string">"&lt;literal style=\"html\"&gt;\n?\n&lt;/literal&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"H"</span> <span class="org-string">"#+html: "</span> <span class="org-string">"&lt;literal style=\"html\"&gt;?&lt;/literal&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"a"</span> <span class="org-string">"#+begin_ascii\n?\n#+end_ascii"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"A"</span> <span class="org-string">"#+ascii: "</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"i"</span> <span class="org-string">"#+index: ?"</span> <span class="org-string">"#+index: ?"</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"I"</span> <span class="org-string">"#+include %file ?"</span> <span class="org-string">"&lt;include file=%file markup=\"?\"&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/mark-next-parent-tasks-todo</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Visit each parent task and change NEXT states to TODO"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>mystate <span class="org-rainbow-delimiters-depth-5">(</span>or <span class="org-rainbow-delimiters-depth-6">(</span>and <span class="org-rainbow-delimiters-depth-7">(</span>fboundp 'org-state<span class="org-rainbow-delimiters-depth-7">)</span>
                          state<span class="org-rainbow-delimiters-depth-6">)</span>
                     <span class="org-rainbow-delimiters-depth-6">(</span>nth 2 <span class="org-rainbow-delimiters-depth-7">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> mystate
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-excursion</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-6">(</span>org-up-heading-safe<span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-7">(</span>member <span class="org-rainbow-delimiters-depth-8">(</span>nth 2 <span class="org-rainbow-delimiters-depth-9">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>list <span class="org-string">"NEXT"</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>org-todo <span class="org-string">"TODO"</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-after-todo-state-change-hook 'bh/mark-next-parent-tasks-todo 'append<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-clock-in-hook 'bh/mark-next-parent-tasks-todo 'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-startup-folded t<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">flyspell mode for spell checking everywhere</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-mode-hook 'turn-on-flyspell 'append<span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-rainbow-delimiters-depth-1">(</span>setq org-src-preserve-indentation nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-edit-src-content-indentation 0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-catch-invisible-edits 'error<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-coding-system 'utf-8<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>prefer-coding-system 'utf-8<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-charset-priority 'unicode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq default-process-coding-system '<span class="org-rainbow-delimiters-depth-2">(</span>utf-8-unix . utf-8-unix<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-time-clocksum-format
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-builtin">:hours</span> <span class="org-string">"%d"</span> <span class="org-builtin">:require-hours</span> t <span class="org-builtin">:minutes</span> <span class="org-string">":%02d"</span> <span class="org-builtin">:require-minutes</span> t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-id-link-to-org-use-id 'create-if-interactive-and-no-custom-id<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-emphasis-alist <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"*"</span> bold <span class="org-string">"&lt;b&gt;"</span> <span class="org-string">"&lt;/b&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                 <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"/"</span> italic <span class="org-string">"&lt;i&gt;"</span> <span class="org-string">"&lt;/i&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                 <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"_"</span> underline <span class="org-string">"&lt;span style=\"text-decoration:underline;\"&gt;"</span> <span class="org-string">"&lt;/span&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                 <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"="</span> org-code <span class="org-string">"&lt;code&gt;"</span> <span class="org-string">"&lt;/code&gt;"</span> verbatim<span class="org-rainbow-delimiters-depth-4">)</span>
                                 <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"~"</span> org-verbatim <span class="org-string">"&lt;code&gt;"</span> <span class="org-string">"&lt;/code&gt;"</span> verbatim<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-use-sub-superscripts nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-odd-levels-only nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>run-at-time <span class="org-string">"00:59"</span> 3600 'org-save-all-org-buffers<span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-comment-delimiter">;;;;;; </span><span class="org-comment">my config </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">remove C-TAB</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-&lt;right&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/mark-next-like-this<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-S-&lt;left&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mc/mark-previous-like-this<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-defkey org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c ["</span><span class="org-rainbow-delimiters-depth-2">)</span> nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-defkey org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c ]"</span><span class="org-rainbow-delimiters-depth-2">)</span> nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-defkey org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-TAB"</span><span class="org-rainbow-delimiters-depth-2">)</span> nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>org-defkey org-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f8&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">use helm iwth org</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-completion-handler 'helm)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">;; Disable keys in org-mode</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;    C-c [ </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;    C-c ]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;    C-c ;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;    C-c C-x C-q  cancelling the clock (we never want this)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-mode-hook</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'(lambda ()</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">;; Undefine C-c [ and C-c ] since this breaks my</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">;; org-agenda files when directories are include It</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">;; expands the files in the directories individually</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(org-defkey org-mode-map "\C-c[" 'undefined)</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(org-defkey org-mode-map "\C-c]" 'undefined)</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(org-defkey org-mode-map "\C-c;" 'undefined)</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(org-defkey org-mode-map "\C-c\C-x\C-q" 'undefined))</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'append)</span>



<span class="org-comment-delimiter">;; </span><span class="org-comment">http://stackoverflow.com/questions/6156286/emacs-lisp-call-function-with-prefix-argument-programmatically</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/org-clock-in-select</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq current-prefix-arg '<span class="org-rainbow-delimiters-depth-3">(</span>4<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">C-u, </span>
  <span class="org-rainbow-delimiters-depth-2">(</span>call-interactively 'org-clock-in<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f11&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'yt/org-clock-in-select<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">add the following </span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-capture-bookmark nil<span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">sacha/yank-more</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>insert <span class="org-string">"[["</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>yank<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>insert <span class="org-string">"][more]]"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'sacha/yank-more<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-time-stamp-custom-formats '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"&lt;%A %d %B %Y&gt;"</span> . <span class="org-string">"&lt;%A %d %B %Y %H:%M&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/open-diary</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"~/git/org/diary.org"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/open-tmp-R</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"~/git/org/tmp.R"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/open-tmp-el</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"~/git/org/tmp.el"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/open-tmp-org</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"~/git/org/tmp.org"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; f r"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'yt/open-tmp-R<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; f e"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'yt/open-tmp-el<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; f d"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'yt/open-diary<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; f o"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'yt/open-tmp-org<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; e"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'mu4e<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f9&gt; g"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'magit-status<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-tags-column 120<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">yt/timeline-for-subtree</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"make a timeline view in agenda for current tree"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-copy-subtree<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>find-file <span class="org-string">"~/tmp/agenda_tmp.org"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>beginning-of-buffer<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>beg <span class="org-rainbow-delimiters-depth-5">(</span>point<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>end-of-buffer<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>delete-region beg <span class="org-rainbow-delimiters-depth-4">(</span>point<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-paste-subtree<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>save-buffer<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-timeline<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">htmlize</span><span class="org-rainbow-delimiters-depth-1">)</span>





<span class="org-rainbow-delimiters-depth-1">(</span>setq org-columns-default-format <span class="org-string">"%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM %10Mindfullness"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-image-actual-width '<span class="org-rainbow-delimiters-depth-2">(</span>400<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">;; add my babel libraries </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(org-babel-lob-ingest "~/git/.emacs.d/yi.babel.org")</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">;; http://stackoverflow.com/questions/23044588/org-mode-creation-time-range-from-effort-estimate/23067020#23067020</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;; effort + schedule -&gt; schedule with duration </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yt/org-schedule-effort ()</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(save-excursion</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(org-back-to-heading t)</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(let* (</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(element (org-element-at-point))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(effort (org-element-property :EFFORT element))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(scheduled (org-element-property :scheduled element))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(ts-year-start (org-element-property :year-start scheduled))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(ts-month-start (org-element-property :month-start scheduled))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(ts-day-start (org-element-property :day-start scheduled))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(ts-hour-start (org-element-property :hour-start scheduled))</span>
<span class="org-comment-delimiter">;;            </span><span class="org-comment">(ts-minute-start (org-element-property :minute-start scheduled)) )</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(org-schedule nil (concat</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">(format "%s" ts-year-start)</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">"-"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">(if (&lt; ts-month-start 10)</span>
<span class="org-comment-delimiter">;;                              </span><span class="org-comment">(concat "0" (format "%s" ts-month-start))</span>
<span class="org-comment-delimiter">;;                            </span><span class="org-comment">(format "%s" ts-month-start))</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">"-"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">(if (&lt; ts-day-start 10)</span>
<span class="org-comment-delimiter">;;                              </span><span class="org-comment">(concat "0" (format "%s" ts-day-start))</span>
<span class="org-comment-delimiter">;;                            </span><span class="org-comment">(format "%s" ts-day-start))</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">" "</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">(if (&lt; ts-hour-start 10)</span>
<span class="org-comment-delimiter">;;                              </span><span class="org-comment">(concat "0" (format "%s" ts-hour-start))</span>
<span class="org-comment-delimiter">;;                            </span><span class="org-comment">(format "%s" ts-hour-start))</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">":"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">(if (&lt; ts-minute-start 10)</span>
<span class="org-comment-delimiter">;;                              </span><span class="org-comment">(concat "0" (format "%s" ts-minute-start))</span>
<span class="org-comment-delimiter">;;                            </span><span class="org-comment">(format "%s" ts-minute-start))</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">"+"</span>
<span class="org-comment-delimiter">;;                          </span><span class="org-comment">effort)) )))</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq bh/hide-scheduled-and-waiting-next-tasks nil<span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-rainbow-delimiters-depth-1">(</span>message <span class="org-string">"end of org"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">ispell region will skip the sorce code and org drawers.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://emacs.stackexchange.com/questions/450/intelligent-spell-checking-in-org-mode</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'ispell-skip-region-alist '(":\\(PROPERTIES\\|LOGBOOK\\):" . ":END:"))</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'ispell-skip-region-alist '("#\\+BEGIN_SRC" . "#\\+END_SRC"))</span>
</pre>
</div>
</div>
<div id="outline-container-sec-4-8-1-1" class="outline-5">
<h5 id="sec-4-8-1-1">Agenda</h5>
<div class="outline-text-5" id="text-4-8-1-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Do not dim blocked tasks</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-dim-blocked-tasks nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Compact the block agenda view</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-compact-blocks nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Custom agenda command definitions</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-custom-commands
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"N"</span> <span class="org-string">"Notes"</span> tags <span class="org-string">"NOTE"</span>
               <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-agenda-overriding-header <span class="org-string">"Notes"</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>org-tags-match-list-sublevels t<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"h"</span> <span class="org-string">"Habits"</span> tags-todo <span class="org-string">"STYLE=\"habit\""</span>
               <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>org-agenda-overriding-header <span class="org-string">"Habits"</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>org-agenda-sorting-strategy
                 '<span class="org-rainbow-delimiters-depth-7">(</span>todo-state-down effort-up category-keep<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">" "</span> <span class="org-string">"Agenda"</span>
               <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>agenda <span class="org-string">""</span> nil<span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-CANCELLED+WAITING|HOLD/!"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-rainbow-delimiters-depth-9">(</span>concat <span class="org-string">"Waiting and Postponed Tasks"</span>
                                                                  <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span class="org-string">""</span>
                                                                    <span class="org-string">" (including WAITING and SCHEDULED tasks)"</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-non-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags <span class="org-string">"RESPONSE"</span>
                      <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-string">"Response"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                       <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-CANCELLED/!NEXT"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-rainbow-delimiters-depth-9">(</span>concat <span class="org-string">"Project Next Tasks"</span>
                                                                  <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span class="org-string">""</span>
                                                                    <span class="org-string">" (including WAITING and SCHEDULED tasks)"</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-projects-and-habits-and-single-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels t<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-sorting-strategy
                             '<span class="org-rainbow-delimiters-depth-9">(</span>todo-state-down effort-up category-keep<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-CANCELLED/!"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-string">"Stuck Projects"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-non-stuck-projects<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-sorting-strategy
                             '<span class="org-rainbow-delimiters-depth-9">(</span>category-keep<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-HOLD-CANCELLED/!"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-string">"Projects"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-non-projects<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels 'indented<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-sorting-strategy
                             '<span class="org-rainbow-delimiters-depth-9">(</span>category-keep<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-REFILE-CANCELLED-WAITING-HOLD/!"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-rainbow-delimiters-depth-9">(</span>concat <span class="org-string">"Project Subtasks"</span>
                                                                  <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span class="org-string">""</span>
                                                                    <span class="org-string">" (including WAITING and SCHEDULED tasks)"</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-non-project-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-sorting-strategy
                             '<span class="org-rainbow-delimiters-depth-9">(</span>category-keep<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags-todo <span class="org-string">"-REFILE-CANCELLED-WAITING-HOLD/!"</span>
                           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-rainbow-delimiters-depth-9">(</span>concat <span class="org-string">"Standalone Tasks"</span>
                                                                  <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span class="org-string">""</span>
                                                                    <span class="org-string">" (including WAITING and SCHEDULED tasks)"</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-project-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-sorting-strategy
                             '<span class="org-rainbow-delimiters-depth-9">(</span>category-keep<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags <span class="org-string">"-REFILE/"</span>
                      <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-string">"Tasks to Archive"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                       <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-skip-function 'bh/skip-non-archivable-tasks<span class="org-rainbow-delimiters-depth-8">)</span>
                       <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                <span class="org-rainbow-delimiters-depth-6">(</span>tags <span class="org-string">"REFILE"</span>
                      <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-overriding-header <span class="org-string">"Tasks to Refile"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                       <span class="org-rainbow-delimiters-depth-8">(</span>org-tags-match-list-sublevels nil<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/org-auto-exclude-function</span> <span class="org-rainbow-delimiters-depth-2">(</span>tag<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Automatic task exclusion in the agenda with / RET"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>and <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>string= tag <span class="org-string">"hold"</span><span class="org-rainbow-delimiters-depth-5">)</span>
         t<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>string= tag <span class="org-string">"farm"</span><span class="org-rainbow-delimiters-depth-5">)</span>
         t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>concat <span class="org-string">"-"</span> tag<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-auto-exclude-function 'bh/org-auto-exclude-function<span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"V"</span> 'bh/view-next-project<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-show-entry-below <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>default<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>org-defkey org-agenda-mode-map <span class="org-string">"\C-c\C-x&lt;"</span> 'bh/set-agenda-restriction-lock<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/set-agenda-restriction-lock</span> <span class="org-rainbow-delimiters-depth-2">(</span>arg<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Set restriction lock to current task subtree or file if prefix is specified"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>pom <span class="org-rainbow-delimiters-depth-5">(</span>bh/get-pom-from-agenda-restriction-or-point<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>tags <span class="org-rainbow-delimiters-depth-5">(</span>org-with-point-at pom <span class="org-rainbow-delimiters-depth-6">(</span>org-get-tags-at<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>restriction-type <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-7">(</span>equal arg 4<span class="org-rainbow-delimiters-depth-7">)</span> 'file 'subtree<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">save-restriction</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">cond</span>
         <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>and <span class="org-rainbow-delimiters-depth-8">(</span>equal major-mode 'org-agenda-mode<span class="org-rainbow-delimiters-depth-8">)</span> pom<span class="org-rainbow-delimiters-depth-7">)</span>
          <span class="org-rainbow-delimiters-depth-7">(</span>org-with-point-at pom
            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-set-restriction-lock restriction-type<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
          <span class="org-rainbow-delimiters-depth-7">(</span>org-agenda-redo<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
         <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>and <span class="org-rainbow-delimiters-depth-8">(</span>equal major-mode 'org-mode<span class="org-rainbow-delimiters-depth-8">)</span> <span class="org-rainbow-delimiters-depth-8">(</span>org-before-first-heading-p<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
          <span class="org-rainbow-delimiters-depth-7">(</span>org-agenda-set-restriction-lock 'file<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
         <span class="org-rainbow-delimiters-depth-6">(</span>pom
          <span class="org-rainbow-delimiters-depth-7">(</span>org-with-point-at pom
            <span class="org-rainbow-delimiters-depth-8">(</span>org-agenda-set-restriction-lock restriction-type<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Limit restriction lock highlighting to the headline only</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-restriction-lock-highlight-subtree nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Always hilight the current agenda line</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'org-agenda-mode-hook
          '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>hl-line-mode 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
          'append<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keep tasks with dates on the global todo lists</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-todo-ignore-with-date nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keep tasks with deadlines on the global todo lists</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-todo-ignore-deadlines nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keep tasks with scheduled dates on the global todo lists</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-todo-ignore-scheduled nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keep tasks with timestamps on the global todo lists</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-todo-ignore-timestamp nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Remove completed deadline tasks from the agenda view</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-skip-deadline-if-done t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Remove completed scheduled tasks from the agenda view</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-skip-scheduled-if-done t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Remove completed items from search results</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-skip-timestamp-if-done t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-include-diary nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-diary-file <span class="org-string">"~/git/org/diary.org"</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-insert-diary-extract-time t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Include agenda archive files when searching for things</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-text-search-extra-files <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span>agenda-archives<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Show all future entries for repeating tasks</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-repeating-timestamp-show-all t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Show all agenda dates - even if they are empty</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-show-all-dates t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Sorting order for tasks on the agenda</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-sorting-strategy
      <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>agenda habit-down time-up user-defined-up effort-up category-keep<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>todo category-up effort-up<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>tags category-up effort-up<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>search category-up<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Start the weekly agenda on Monday</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-start-on-weekday 1<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Enable display of the time grid so we can see the marker for the current time</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-time-grid <span class="org-rainbow-delimiters-depth-2">(</span>quote <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>daily today remove-match<span class="org-rainbow-delimiters-depth-4">)</span>
                                   #<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"----------------"</span> 0 16 <span class="org-rainbow-delimiters-depth-5">(</span>org-heading t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                                   <span class="org-rainbow-delimiters-depth-4">(</span>0700 0800 0900 1000 1100 1200 1200 1300 1400 1500 1600 1700<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Display tags farther right</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-tags-column -102)</span>

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Agenda sorting functions</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-cmp-user-defined 'bh/agenda-sort<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/agenda-sort</span> <span class="org-rainbow-delimiters-depth-2">(</span>a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Sorting strategy for agenda items.</span>
<span class="org-doc">Late deadlines first, then scheduled, then non-late deadlines"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span>result num-a num-b<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">time specific items are already sorted first by org-agenda-sorting-strategy</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">non-deadline and non-scheduled items next</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test 'bh/is-not-scheduled-or-deadline a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">deadlines for today next</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test 'bh/is-due-deadline a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">late deadlines next</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test-num 'bh/is-late-deadline '&gt; a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">scheduled items for today next</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test 'bh/is-scheduled-today a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">late scheduled items next</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test-num 'bh/is-scheduled-late '&gt; a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">pending deadlines last</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>bh/agenda-sort-test-num 'bh/is-pending-deadline '&lt; a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>

                                        <span class="org-comment-delimiter">; </span><span class="org-comment">finally default to unsorted</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>t <span class="org-rainbow-delimiters-depth-5">(</span>setq result nil<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    result<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defmacro</span> <span class="org-function-name">bh/agenda-sort-test</span> <span class="org-rainbow-delimiters-depth-2">(</span>fn a b<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Test for agenda sort"</span>
  `<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">if both match leave them unsorted</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>and <span class="org-rainbow-delimiters-depth-5">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-6">(</span>list ,a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-6">(</span>list ,b<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>setq result nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">if a matches put a first</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-5">(</span>list ,a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>setq result -1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">otherwise if b matches put b first</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-5">(</span>list ,b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>setq result 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">if none match leave them unsorted</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>t nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defmacro</span> <span class="org-function-name">bh/agenda-sort-test-num</span> <span class="org-rainbow-delimiters-depth-2">(</span>fn compfn a b<span class="org-rainbow-delimiters-depth-2">)</span>
  `<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-5">(</span>list ,a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>setq num-a <span class="org-rainbow-delimiters-depth-5">(</span>string-to-number <span class="org-rainbow-delimiters-depth-6">(</span>match-string 1 ,a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-6">(</span>list ,b<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
         <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">progn</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>setq num-b <span class="org-rainbow-delimiters-depth-7">(</span>string-to-number <span class="org-rainbow-delimiters-depth-8">(</span>match-string 1 ,b<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
           <span class="org-rainbow-delimiters-depth-6">(</span>setq result <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-8">(</span>apply ,compfn <span class="org-rainbow-delimiters-depth-9">(</span>list num-a num-b<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span>
                            -1
                          1<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
       <span class="org-rainbow-delimiters-depth-5">(</span>setq result -1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>apply ,fn <span class="org-rainbow-delimiters-depth-5">(</span>list ,b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span>setq result 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>t nil<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-not-scheduled-or-deadline</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>and <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>bh/is-deadline date-str<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>bh/is-scheduled date-str<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-due-deadline</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>string-match <span class="org-string">"Deadline:"</span> date-str<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-late-deadline</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>string-match <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[0-9]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> d\. ago:"</span> date-str<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-pending-deadline</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>string-match <span class="org-string">"In </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">-]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">d\.:"</span> date-str<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-deadline</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>or <span class="org-rainbow-delimiters-depth-3">(</span>bh/is-due-deadline date-str<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>bh/is-late-deadline date-str<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>bh/is-pending-deadline date-str<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-scheduled</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>or <span class="org-rainbow-delimiters-depth-3">(</span>bh/is-scheduled-today date-str<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>bh/is-scheduled-late date-str<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-scheduled-today</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>string-match <span class="org-string">"Scheduled:"</span> date-str<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">bh/is-scheduled-late</span> <span class="org-rainbow-delimiters-depth-2">(</span>date-str<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>string-match <span class="org-string">"Sched\.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">x:"</span> date-str<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Use sticky agenda's so they persist</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-agenda-sticky t<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">The following setting is different from the document so that you</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">can override the document path by setting your path in the variable</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">org-mode-user-contrib-lisp-path</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>boundp 'org-mode-user-contrib-lisp-path<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>add-to-list 'load-path org-mode-user-contrib-lisp-path<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>add-to-list 'load-path <span class="org-rainbow-delimiters-depth-3">(</span>expand-file-name <span class="org-string">"~/git/org-mode/contrib/lisp"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">org-checklist</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-8-2" class="outline-4">
<h4 id="sec-4-8-2">PDF Export</h4>
<div class="outline-text-4" id="text-4-8-2">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">http://emacs-fu.blogspot.co.uk/2011/04/nice-looking-pdfs-with-org-mode-and.html</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">'djcb-org-article' for export org documents to the LaTex 'article', using</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">XeTeX and some fancy fonts; requires XeTeX (see org-latex-to-pdf-process)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'org-latex-classes
                 '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"yt/org-article"</span>
                   <span class="org-string">"</span>
<span class="org-string">\\documentclass[11pt,a4paper]{article}</span>
<span class="org-string">\\usepackage{graphicx}    %% demo mode is a must when .img does not exists.</span>
<span class="org-string">\\usepackage[T1]{fontenc}</span>
<span class="org-string">\\usepackage{fontspec}</span>
<span class="org-string">\\usepackage{hyperref}</span>
<span class="org-string">\\usepackage{amstext}</span>
<span class="org-string">\\usepackage{amssymb} %% checkbox</span>
<span class="org-string">\\usepackage{minted}</span>
<span class="org-string">\\defaultfontfeatures{Mapping=tex-text}</span>
<span class="org-string">\\setromanfont{Gentium}</span>
<span class="org-string">\\setromanfont [BoldFont={Gentium Basic Bold},</span>
<span class="org-string">                ItalicFont={Gentium Basic Italic}]{Gentium Basic}</span>
<span class="org-string">\\setsansfont{Charis SIL}</span>
<span class="org-string">\\setmonofont[Scale=0.8]{DejaVu Sans Mono}</span>
<span class="org-string">\\usepackage{geometry}</span>
<span class="org-string">\\geometry{a4paper, textwidth=6.5in, textheight=10in,</span>
<span class="org-string">            marginparsep=7pt, marginparwidth=.6in}</span>
<span class="org-string">\\pagestyle{empty}</span>

<span class="org-string">%% package from org-latex-default-packages-alist</span>
<span class="org-string">\\usepackage{setspace}</span>
<span class="org-string">\\onehalfspacing</span>
<span class="org-string">\\usepackage{textcomp}</span>
<span class="org-string">\\usepackage{marvosymb}</span>
<span class="org-string">\\usepackage{wasysym}</span>
<span class="org-string">\\usepackage{ulem}</span>

<span class="org-string">\\renewcommand\\texttt[1]{{\\mint{cl}|#1|}} </span>

<span class="org-string">\\title{}</span>
<span class="org-string">      [NO-DEFAULT-PACKAGES]</span>
<span class="org-string">      [NO-PACKAGES]"</span>
                   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\section{%s}"</span> . <span class="org-string">"\\section*{%s}"</span><span class="org-rainbow-delimiters-depth-3">)</span>
                   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\subsection{%s}"</span> . <span class="org-string">"\\subsection*{%s}"</span><span class="org-rainbow-delimiters-depth-3">)</span>
                   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\subsubsection{%s}"</span> . <span class="org-string">"\\subsubsection*{%s}"</span><span class="org-rainbow-delimiters-depth-3">)</span>
                   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph*{%s}"</span><span class="org-rainbow-delimiters-depth-3">)</span>
                   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph*{%s}"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-latex-default-class <span class="org-string">"yt/org-article"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">code highlights using minted package </span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'org-latex-packages-alist '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">""</span> <span class="org-string">"minted"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-latex-listings 'minted<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-latex-minted-options
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"frame"</span> <span class="org-string">"lines"</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"fontsize"</span> <span class="org-string">"\\scriptsize"</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"linenos"</span> <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;;;; </span><span class="org-comment">comple pdf </span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-latex-pdf-process
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
<div id="outline-container-sec-4-8-2-1" class="outline-5">
<h5 id="sec-4-8-2-1"><span class="todo TODO">TODO</span> fix xelatex compilation problem</h5>
<div class="outline-text-5" id="text-4-8-2-1">
<p>

</p>
</div>
</div>
</div>
<div id="outline-container-sec-4-8-3" class="outline-4">
<h4 id="sec-4-8-3">HTML Export</h4>
<div class="outline-text-4" id="text-4-8-3">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">http://sachachua.com/blog/2014/03/emacs-tweaks-export-org-checkboxes-using-utf-8-symbols/</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">sacha/org-html-checkbox</span> <span class="org-rainbow-delimiters-depth-2">(</span>checkbox<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Format CHECKBOX into HTML."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>case checkbox <span class="org-rainbow-delimiters-depth-3">(</span>on <span class="org-string">"&lt;span class=\"check\"&gt;&amp;#x2611;&lt;/span&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">; </span><span class="org-comment">checkbox (checked)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>off <span class="org-string">"&lt;span class=\"checkbox\"&gt;&amp;#x2610;&lt;/span&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>trans <span class="org-string">"&lt;code&gt;[-]&lt;/code&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>t <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defadvice</span> <span class="org-function-name">org-html-checkbox</span> <span class="org-rainbow-delimiters-depth-2">(</span>around sacha activate<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>setq ad-return-value <span class="org-rainbow-delimiters-depth-3">(</span>sacha/org-html-checkbox <span class="org-rainbow-delimiters-depth-4">(</span>ad-get-arg 0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-head <span class="org-string">"&lt;link rel=\"stylesheet\" type=\"text/css\"</span>
<span class="org-string">href=\"http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/foundation.min.css\"&gt;&lt;/link&gt;</span>
<span class="org-string">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"http://sachachua.com/org-export.css\"&gt;&lt;/link&gt;</span>
<span class="org-string">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"http://sachachua.com/blog/wp-content/themes/sacha-v3/style.css\"&gt;&lt;/link&gt;</span>
<span class="org-string">&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\"&gt;&lt;/script&gt;"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-htmlize-output-type 'css<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-src-fontify-natively t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-preamble <span class="org-string">"&lt;a name=\"top\" id=\"top\"&gt;&lt;/a&gt;"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-postamble <span class="org-string">"</span>
<span class="org-string">&lt;style type=\"text/css\"&gt;</span>
<span class="org-string">.back-to-top {</span>
<span class="org-string">    position: fixed;</span>
<span class="org-string">    bottom: 2em;</span>
<span class="org-string">    right: 0px;</span>
<span class="org-string">    text-decoration: none;</span>
<span class="org-string">    color: #000000;</span>
<span class="org-string">    background-color: rgba(235, 235, 235, 0.80);</span>
<span class="org-string">    font-size: 12px;</span>
<span class="org-string">    padding: 1em;</span>
<span class="org-string">    display: none;</span>
<span class="org-string">}</span>
<span class="org-string">.back-to-top:hover {    </span>
<span class="org-string">    background-color: rgba(135, 135, 135, 0.50);</span>
<span class="org-string">}</span>
<span class="org-string">&lt;/style&gt;</span>
<span class="org-string">&lt;div class=\"back-to-top\"&gt;</span>
<span class="org-string">&lt;a href=\"#top\"&gt;Back to top&lt;/a&gt; | &lt;a href=\"mailto:sacha@sachachua.com\"&gt;E-mail me&lt;/a&gt;</span>
<span class="org-string">&lt;/div&gt;</span>
<span class="org-string">&lt;script type=\"text/javascript\"&gt;</span>
<span class="org-string">    var offset = 220;</span>
<span class="org-string">    var duration = 500;</span>
<span class="org-string">    jQuery(window).scroll(function() {</span>
<span class="org-string">        if (jQuery(this).scrollTop() &gt; offset) {</span>
<span class="org-string">            jQuery('.back-to-top').fadeIn(duration);</span>
<span class="org-string">        } else {</span>
<span class="org-string">            jQuery('.back-to-top').fadeOut(duration);</span>
<span class="org-string">        }</span>
<span class="org-string">    });</span>
<span class="org-string">&lt;/script&gt;"</span><span class="org-rainbow-delimiters-depth-1">)</span>


<span class="org-comment-delimiter">;; </span><span class="org-comment">Inline images in HTML instead of producting links to the image</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-html-inline-images t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Do not use sub or superscripts - I currently don't need this functionality in my documents</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-with-sub-superscripts t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Export with LaTeX fragments</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-with-LaTeX-fragments t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Increase default number of headings to export</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-export-headline-levels 6<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-8-4" class="outline-4">
<h4 id="sec-4-8-4">Blogging with Jekyll</h4>
<div class="outline-text-4" id="text-4-8-4">
<p>
I have encountered people who wants to blog, but never start it or quit at the beigining.  I've used wordpress, online editing, and others, but never a big fan or if. because you have to learn how to write the html code, before you thinking what to write.  I think this is the reason many people quit. 
</p>

<p>
Since I've been use org-mode, and did lot of publishing work, either for client, or colluge.  I usually keep learning notes in org-mode, and sometimes want to share with otehrs, and doing it in org-mode make it less hazzord to share with others, via org-mode-publish. 
</p>

<p>
so the currenlt workflow now is:
</p>

<ol class="org-ol">
<li>keep a note

<p>
I tent to keep notes about creazy ideas I learnt, some tehnical stuff I learnt. if I feel it is necessary to share, either because there's good online material, or I think I shuold standard out and speak, for exmaple, the upcomming artile about intro to data.table in R, and few Emacs's thing.  
</p>
</li>

<li>write &amp; Edit 

<p>
for a persoal note, I always keep it short, and to the exactly out, and it also fit it the big project that I defined.  if I take it out, one may feel it lost the context.  also, writing is not only about the problem-solutiion, but mora ebout analyse the problem, convicne people etc.  I need to find reference, highlight code, add picture etc. 
</p>
</li>

<li>share 

<p>
once I feel the artiel is ready to share, I can run the <code>org-publish</code> to generate the html file.  and push it to Github Page. 
</p>
</li>

<li>Render 

<p>
currently I use Jekyll to build the site, I haven't done any research about other servei, since it is do a very good job, thereisn't necessary to find a better one, as for a blog, the most important thing is the content.
</p>
</li>
</ol>

<p>
Jeklly have few conventins, like the new, YAML etc, it is better to solve it autoamtilcally and in Emacs, as part of the export process. 
</p>


<p>
First, define a publish project, so that the exported html file will go to certail place, and we can define the styles, and other features for a praticularlly project.  but for Jeklly, it is more about to match the constraints.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">ref: http://cute-jumper.github.io/emacs/2013/10/06/orgmode-to-github-pages-with-jekyll/</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq org-publish-project-alist
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"yi-tang-github-io"</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">settings for cute-jumper.github.io</span>
         <span class="org-builtin">:base-directory</span> <span class="org-string">"~/git/yi-tang.github.io/org"</span>
         <span class="org-builtin">:base-extension</span> <span class="org-string">"org"</span>
         <span class="org-builtin">:publishing-directory</span> <span class="org-string">"~/git/yi-tang.github.io"</span>
         <span class="org-builtin">:recursive</span> t
         <span class="org-builtin">:publishing-function</span> org-html-publish-to-html
         <span class="org-builtin">:with-toc</span> nil
         <span class="org-builtin">:headline-levels</span> 4
         <span class="org-builtin">:section-numbers</span> nil
         <span class="org-builtin">:auto-preamble</span> nil
         <span class="org-builtin">:auto-sitemap</span> nil
         <span class="org-builtin">:html-extension</span> <span class="org-string">"html"</span>
         <span class="org-builtin">:htmlized-source</span> t
         <span class="org-builtin">:body-only</span> t
         <span class="org-builtin">:with-toc</span> nil
         <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
For managing a blog, it is good idea to keep the original org file inside of the website.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-directory</span> <span class="org-rainbow-delimiters-depth-2">(</span>expand-file-name <span class="org-string">"~/git/yi-tang.github.io/org/"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Path to Jekyll blog."</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-drafts-dir</span> <span class="org-string">"_drafts/"</span>
  <span class="org-doc">"Relative path to drafts directory."</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-posts-dir</span> <span class="org-string">"_posts/"</span>
  <span class="org-doc">"Relative path to posts directory."</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-post-ext</span> <span class="org-string">".org"</span>
  <span class="org-doc">"File extension of Jekyll posts."</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-post-template</span>
  <span class="org-string">" </span>
<span class="org-string">#+BEGIN_HTML</span>
<span class="org-string">---</span>
<span class="org-string">layout: post</span>
<span class="org-string">title: %s</span>
<span class="org-string">excerpt: </span>
<span class="org-string">categories:</span>
<span class="org-string">  -  </span>
<span class="org-string">tags:</span>
<span class="org-string">  -</span>
<span class="org-string">comments: true </span>
<span class="org-string">---</span>
<span class="org-string">#+END_HTML</span>

<span class="org-string">#+call: GetLastUpdatedDate[:exports none]()[:results org]</span>

<span class="org-string">#+TOC: headlines 4</span>
<span class="org-string">"</span>
    <span class="org-doc">"Default template for Jekyll posts. %s will be replace by the post title."</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">jekyll-make-slug</span> <span class="org-rainbow-delimiters-depth-2">(</span>s<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Turn a string into a slug."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>replace-regexp-in-string
   <span class="org-string">" "</span> <span class="org-string">"-"</span> <span class="org-rainbow-delimiters-depth-3">(</span>downcase
            <span class="org-rainbow-delimiters-depth-4">(</span>replace-regexp-in-string
             <span class="org-string">"[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">A-Za-z0-9 ]"</span> <span class="org-string">""</span> s<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">jekyll-yaml-escape</span> <span class="org-rainbow-delimiters-depth-2">(</span>s<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Escape a string for YAML."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>or <span class="org-rainbow-delimiters-depth-4">(</span>string-match <span class="org-string">":"</span> s<span class="org-rainbow-delimiters-depth-4">)</span>
        2  <span class="org-rainbow-delimiters-depth-4">(</span>string-match <span class="org-string">"\""</span> s<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>concat <span class="org-string">"\""</span> <span class="org-rainbow-delimiters-depth-4">(</span>replace-regexp-in-string <span class="org-string">"\""</span> <span class="org-string">"\\\\\""</span> s<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-string">"\""</span><span class="org-rainbow-delimiters-depth-3">)</span>
    s<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">blog-draft-post</span> <span class="org-rainbow-delimiters-depth-2">(</span>title<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Create a new Jekyll blog post."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive <span class="org-string">"sPost Title: "</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>draft-file <span class="org-rainbow-delimiters-depth-5">(</span>concat jekyll-directory jekyll-drafts-dir
                            <span class="org-rainbow-delimiters-depth-6">(</span>jekyll-make-slug title<span class="org-rainbow-delimiters-depth-6">)</span>
                            jekyll-post-ext<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>file-exists-p draft-file<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>find-file draft-file<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>find-file draft-file<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>insert <span class="org-rainbow-delimiters-depth-5">(</span>format jekyll-post-template <span class="org-rainbow-delimiters-depth-6">(</span>jekyll-yaml-escape title<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">blog-publish-post</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Move a draft post to the posts directory, and rename it so that it</span>
<span class="org-doc"> contains the date."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>not <span class="org-rainbow-delimiters-depth-5">(</span>equal
          <span class="org-rainbow-delimiters-depth-6">(</span>file-name-directory <span class="org-rainbow-delimiters-depth-7">(</span>buffer-file-name <span class="org-rainbow-delimiters-depth-8">(</span>current-buffer<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>concat jekyll-directory jekyll-drafts-dir<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"This is not a draft post."</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>buffer-modified-p<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"Can't publish post; buffer has modifications."</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
   <span class="org-rainbow-delimiters-depth-3">(</span>t
    <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>filename
           <span class="org-rainbow-delimiters-depth-7">(</span>concat jekyll-directory jekyll-posts-dir
                   <span class="org-rainbow-delimiters-depth-8">(</span>format-time-string <span class="org-string">"%Y-%m-%d-"</span><span class="org-rainbow-delimiters-depth-8">)</span>
                   <span class="org-rainbow-delimiters-depth-8">(</span>file-name-nondirectory
                    <span class="org-rainbow-delimiters-depth-9">(</span>buffer-file-name <span class="org-rainbow-delimiters-depth-1">(</span>current-buffer<span class="org-rainbow-delimiters-depth-1">)</span><span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>old-point <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>rename-file <span class="org-rainbow-delimiters-depth-6">(</span>buffer-file-name <span class="org-rainbow-delimiters-depth-7">(</span>current-buffer<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                   filename<span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>kill-buffer nil<span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>find-file filename<span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>set-window-point <span class="org-rainbow-delimiters-depth-6">(</span>selected-window<span class="org-rainbow-delimiters-depth-6">)</span> old-point<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">org-jekyll-post-link-follow</span> <span class="org-rainbow-delimiters-depth-2">(</span>path<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-open-file-with-emacs path<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">org-jekyll-post-link-export</span> <span class="org-rainbow-delimiters-depth-2">(</span>path desc format<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>eq format 'html<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>format <span class="org-string">"&lt;a href=\"{%% post_url %s %%}\"&gt;%s&lt;/a&gt;"</span> path desc<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>org-add-link-type <span class="org-string">"jekyll-post"</span> 'org-jekyll-post-link-follow 'org-jekyll-post-link-export<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Improve our blogging experience with Org-Jekyll. This code sets four</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">functions with corresponding key bindings:</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j n - Create new draft</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j P - Post current draft</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j d - Show all drafts</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j p - Show all posts</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Once a draft has been posted (i.e., moved from the _drafts</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">directory to _post with the required date prefix in the filename), we</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">then need to html-export it to the jekyll rootdir (with org-publish).</span>

<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c j n"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'blog-draft-post<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c j P"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'blog-publish-post<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c j p"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
                                  <span class="org-rainbow-delimiters-depth-3">(</span>interactive<span class="org-rainbow-delimiters-depth-3">)</span>
                                  <span class="org-rainbow-delimiters-depth-3">(</span>find-file <span class="org-string">"~/git/yi-tang.github.io/org/_posts/"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c j d"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
                                  <span class="org-rainbow-delimiters-depth-3">(</span>interactive<span class="org-rainbow-delimiters-depth-3">)</span>
                                  <span class="org-rainbow-delimiters-depth-3">(</span>find-file <span class="org-string">"~/git/yi-tang.github.io/org/_drafts/"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
<div id="outline-container-sec-4-8-4-1" class="outline-5">
<h5 id="sec-4-8-4-1">code highlight</h5>
<div class="outline-text-5" id="text-4-8-4-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">org-to-jekyll-src</span> <span class="org-rainbow-delimiters-depth-2">(</span>lang<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">" change src block heading to {% highlight %} "</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-temp-buffer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert-file "current buffer name")</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>goto-char <span class="org-rainbow-delimiters-depth-3">(</span>point-min<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-3">(</span>not <span class="org-rainbow-delimiters-depth-4">(</span>eobp<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>looking-at <span class="org-rainbow-delimiters-depth-6">(</span>concat <span class="org-string">"^#\\+BEGIN_SRC "</span> lang <span class="org-string">".*$"</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>goto-char <span class="org-rainbow-delimiters-depth-6">(</span>match-beginning 0<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>kill-line<span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>insert <span class="org-string">"#+begin_html"</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>insert <span class="org-rainbow-delimiters-depth-6">(</span>concat <span class="org-string">"{% highlight "</span> lang <span class="org-string">" linenos %}"</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>looking-at <span class="org-string">"^#\\+END_SRC"</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>goto-char <span class="org-rainbow-delimiters-depth-6">(</span>match-beginning 0<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>kill-line<span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>insert <span class="org-string">"{% highlight %}"</span><span class="org-rainbow-delimiters-depth-5">)</span>
      <span class="org-rainbow-delimiters-depth-5">(</span>insert <span class="org-string">"#+end_html"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">org-src-jekyll</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"use jekyll highlight style"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-to-jekyll-src <span class="org-string">"R"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-to-jekyll-src <span class="org-string">"C++"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-to-jekyll-src <span class="org-string">"emacs-lisp"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-to-jekyll-src <span class="org-string">"CSS"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>org-to-jekyll-src <span class="org-string">"html"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-9" class="outline-3">
<h3 id="sec-4-9">Initialisation Completed</h3>
<div class="outline-text-3" id="text-4-9">
<p>

</p>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Babel Library</h2>
<div class="outline-text-2" id="text-5">
<p>
to load a 
</p>
<pre class="example">
(org-babel-lob-ingest "~/git/.emacs.d/yi.babel.org)
</pre>
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Update Emacs library</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-sh" id="UpdateEmacsPackages">cask install --path ~/git/.emacs.d
cask upgrade-cask --path ~/git/.emacs.d
git add -A 
git commit -m <span class="org-string">"cask update $(</span><span class="org-sh-quoted-exec">date</span><span class="org-string">)"</span>
git push
</pre>
</div>

<pre class="example">
#+call: UpdateEmacsPackages()

#+results:
: [master 3f5c750] cask update Sat Nov  8 18:06:08 GMT 2014
:  2 files changed, 7 insertions(+), 3 deletions(-)
:  delete mode 120000 .#yi.babel.org
</pre>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">Ledger</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">

<pre class="src src-sh" id="WeeklyExp">ledger --period <span class="org-string">"this week"</span> --start-of-week=1 -f ~/git/ImportantFiles/ledger register Exp -S <span class="org-string">"date, amount"</span> 


<span class="org-comment-delimiter"># </span><span class="org-comment">ledger --period "this week" -f ~/ledger register Exp -S "date, amount" --start-of-week=1 # last week's expense, sort by day, then by amount</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">Weekly_Exp_Summary</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ledger --period "this week" -f ~/ledger register Exp --by-payee --collapse --sort "amount" --start-of-week=1  ## this week's expense, grouped by payee with sum,</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh" id="Weekly_Exp_Summary"><span class="org-comment-delimiter">## </span><span class="org-comment">Weekly_Exp_Summary</span>
ledger --period <span class="org-string">"this week"</span> -f ~/ledger register Exp --by-payee --collapse --sort <span class="org-string">"amount"</span> --start-of-week=1  <span class="org-comment-delimiter">## </span><span class="org-comment">this week's expense, grouped by payee with sum,</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh" id="Ledger_Monthly_Balance_Exp">ledger --period <span class="org-string">"this month"</span> -f ~/git/ImportantFiles/ledger bal Exp <span class="org-comment-delimiter"># </span><span class="org-comment">monthly expense</span>
</pre>
</div>


<pre class="example">
#+call: Weekly_Exp_Summary()

#+results:
: 14-Nov-04 Skipton               Expenses:Transport            2.50        2.50
: 14-Nov-03 Rebecca-Stroud        Expenses:Transport            3.00        5.50
: 14-Nov-08 Costa                 &lt;Total&gt;                       4.40        9.90
: 14-Nov-03 GiffGaff              Expenses:Bill:Phone          12.00       21.90
: 14-Nov-03 Sky                   Expenses:Bill:Internet       12.70       34.60
: 14-Nov-06 Morisson              Expenses:Grocery             16.87       51.47
: 14-Nov-03 UK-GOV                &lt;Total&gt;                     172.35      223.82
</pre>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">image process</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">

<pre class="src src-sh" id="Extract_PDF_Pages"><span class="org-comment-delimiter">## </span><span class="org-comment">http://www.linuxjournal.com/content/tech-tip-extract-pages-pdf</span>
<span class="org-keyword">function</span> <span class="org-function-name">pdfpextr</span><span class="org-rainbow-delimiters-depth-1">()</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">this function uses 3 arguments:</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$1 is the first page of the range to extract</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$2 is the last page of the range to extract</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$3 is the input file</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">output file will be named "inputfile_pXX-pYY.pdf"</span>
    <span class="org-comment-delimiter"># </span><span class="org-warning">TODO</span><span class="org-comment">: add format=png option </span>
    gs -sDEVICE=pdfwrite -dNOPAUSE -dBATCH -dSAFER <span class="org-sh-escaped-newline">\</span>
       -dFirstPage=$<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">1</span><span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-sh-escaped-newline">\</span>
       -dLastPage=$<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">2</span><span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-sh-escaped-newline">\</span>
       -sOutputFile=$<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">3</span>%.pdf<span class="org-rainbow-delimiters-depth-2">}</span>_p$<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">1</span><span class="org-rainbow-delimiters-depth-2">}</span>-p$<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">2</span><span class="org-rainbow-delimiters-depth-2">}</span>.pdf <span class="org-sh-escaped-newline">\</span>
       $<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-variable-name">3</span><span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
pdfpextr $<span class="org-variable-name">pageStart</span> $<span class="org-variable-name">pageEnd</span> $<span class="org-variable-name">pdfFile</span>
</pre>
</div>

<pre class="example">
#+name: Extract_PDF_Pages[:dir ~/git/org/img](1, 10, "tmp.pdf")
</pre>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">org contact</h3>
<div class="outline-text-3" id="text-5-4">
<p>

</p>
<div class="org-src-container">

<pre class="src src-elisp" id="GetContactGroup"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">GetContactGroup</span> <span class="org-rainbow-delimiters-depth-2">(</span>contact-file search-tag contact-type<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>interactive<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>name-address <span class="org-rainbow-delimiters-depth-5">(</span>org-map-entries <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">lambda</span><span class="org-rainbow-delimiters-depth-7">()</span>
                                 <span class="org-rainbow-delimiters-depth-7">(</span>cons <span class="org-rainbow-delimiters-depth-8">(</span>elt <span class="org-rainbow-delimiters-depth-9">(</span>org-heading-components<span class="org-rainbow-delimiters-depth-9">)</span> 4<span class="org-rainbow-delimiters-depth-8">)</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">get headline (name) </span>
                                       <span class="org-rainbow-delimiters-depth-8">(</span>org-entry-get nil contact-type<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">get Email/phone etc property </span>
                               search-tag
                               contact-file<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>mapconcat <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>a-list<span class="org-rainbow-delimiters-depth-5">)</span>
                  <span class="org-rainbow-delimiters-depth-5">(</span>concat <span class="org-rainbow-delimiters-depth-6">(</span>car a-list<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">" &lt;"</span> <span class="org-rainbow-delimiters-depth-6">(</span>cdr a-list<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">"&gt;"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                name-address <span class="org-string">", "</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>GetContactGroup contact-file search-tag contact-type<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example">
#+call: GetContactGroup('("~/git/org/contacts.org"), "SFG", "EMAIL")
#+results:
: Elizabeth Wood &lt;Elizabeth.Wood@jbaconsulting.com&gt;, Gary Savage &lt;Gary.Savage@jbarisk.com&gt;, James Ramm &lt;James.Ramm@jbarisk.com&gt;, Jennifer Hornsby &lt;Jennifer.Hornsby@jbaconsulting.com&gt;, Naomi Booth &lt;Naomi.Booth@jbarisk.com&gt;, Rob Lamb &lt;Rob.Lamb@jbatrust.org&gt;, Ross Towe &lt;Ross.Towe@jbaconsulting.com&gt;, Sarah Warren &lt;Sarah.Warren@jbaconsulting.com&gt;, Zora van Leeuwen &lt;Zora.VanLeeuwen@jbaconsulting.com&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">Blog</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">

<pre class="src src-R" id="GetBlogPosts">posts.dir <span class="org-constant">&lt;-</span> <span class="org-string">"~/git/yi-tang.github.io/org/_posts"</span>
all.posts <span class="org-constant">&lt;-</span> list.files<span class="org-rainbow-delimiters-depth-1">(</span>posts.dir, pattern = <span class="org-string">".org$"</span><span class="org-rainbow-delimiters-depth-1">)</span>
sapply<span class="org-rainbow-delimiters-depth-1">(</span>seq_along<span class="org-rainbow-delimiters-depth-2">(</span>all.posts<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-keyword">function</span><span class="org-rainbow-delimiters-depth-2">(</span>i<span class="org-rainbow-delimiters-depth-2">){</span>
headline <span class="org-constant">&lt;-</span> paste0<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"* "</span>, all.posts<span class="org-rainbow-delimiters-depth-4">[</span>i<span class="org-rainbow-delimiters-depth-4">]</span><span class="org-rainbow-delimiters-depth-3">)</span>
content <span class="org-constant">&lt;-</span> paste0<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"#+INCLUDE: "</span>, <span class="org-string">'"'</span>, file.path<span class="org-rainbow-delimiters-depth-4">(</span>posts.dir, all.posts<span class="org-rainbow-delimiters-depth-5">[</span>i<span class="org-rainbow-delimiters-depth-5">]</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-string">'"'</span><span class="org-rainbow-delimiters-depth-3">)</span>
page.break <span class="org-constant">&lt;-</span> <span class="org-string">"#+latex: \\newpage"</span>
paste<span class="org-rainbow-delimiters-depth-3">(</span>headline, content, page.break, sep = <span class="org-string">"\n"</span><span class="org-rainbow-delimiters-depth-3">)</span>
<span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div class="org-src-container">

<pre class="src src-emacs-lisp" id="GetLastUpdatedDate-:eval-no"><span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yt/last-updated-date ()</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">"return modification time of current file-visitng buffer"</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((y (format-time-string "%d %b %Y" (visited-file-modtime))))</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(concat  "/Last Updated/: " y))) ;; print out results </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(yt/last-updated-date)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">End</h2>
<div class="outline-text-2" id="text-6">
<p>

</p>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">C++</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key [(f9)] 'compile)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq compilation-window-height 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>setq compilation-finish-function
      <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>buf str<span class="org-rainbow-delimiters-depth-3">)</span>

        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>string-match <span class="org-string">"exited abnormally"</span> str<span class="org-rainbow-delimiters-depth-4">)</span>

            <span class="org-comment-delimiter">;;</span><span class="org-comment">there were errors</span>
            <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"compilation errors, press C-x ` to visit"</span><span class="org-rainbow-delimiters-depth-4">)</span>

          <span class="org-comment-delimiter">;;</span><span class="org-comment">no errors, make the compilation window go away in 0.5 seconds</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>run-at-time 0.5 nil 'delete-windows-on buf<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"NO COMPILATION ERRORS!"</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>



<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">indent-buffer-ask</span><span class="org-rainbow-delimiters-depth-2">()</span>
   <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-3">(</span>y-or-n-p <span class="org-string">"Indent buffer before saving? "</span><span class="org-rainbow-delimiters-depth-3">)</span>
     <span class="org-rainbow-delimiters-depth-3">(</span>indent-region <span class="org-rainbow-delimiters-depth-4">(</span>point-min<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>point-max<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">indent-buffer-no-ask</span><span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>indent-region <span class="org-rainbow-delimiters-depth-3">(</span>point-min<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>point-max<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>setq c++-mode-hook
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>c-set-style <span class="org-string">"cc-mode"</span><span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>define-key c++-mode-map <span class="org-string">"\C-c\C-c"</span> 'compile<span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>define-key c++-mode-map <span class="org-string">"\C-c\C-e"</span> 'next-error<span class="org-rainbow-delimiters-depth-3">)</span>
<span class="org-comment-delimiter">;        </span><span class="org-comment">(add-hook 'before-save-hook 'indent-buffer-ask nil t)                  </span>
         <span class="org-rainbow-delimiters-depth-3">(</span>add-hook 'before-save-hook 'indent-buffer-no-ask nil t<span class="org-rainbow-delimiters-depth-3">)</span>  <span class="org-comment-delimiter">;; </span><span class="org-comment">indent c++ files after save.</span>
<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>




<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">flymake-google-cpplint</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c++-mode-hook 'flymake-google-cpplint-load<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(custom-set-variables</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">'(flymake-google-cpplint-command "/Library/Python/2.7/site-packages/cpplint/cpplint.py"))</span>
<span class="org-comment-delimiter">;</span><span class="org-comment">"/usr/local/bin/cpplint"))</span>

<span class="org-comment-delimiter">; </span><span class="org-comment">start google-c-style with emacs</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">google-c-style</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c-mode-common-hook 'google-set-c-style<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c++-mode-common-hook 'google-make-newline-indent<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">test</h2>
<div class="outline-text-2" id="text-8">
<p>

</p>

<div class="org-src-container">

<pre class="src src-R">alalalal &lt;rnorm<span class="org-rainbow-delimiters-depth-1">(</span>1e3<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-r">rnorm<span class="org-rainbow-delimiters-depth-1">(</span>1e3<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<style type="text/css">
.back-to-top {
    position: fixed;
    bottom: 2em;
    right: 0px;
    text-decoration: none;
    color: #000000;
    background-color: rgba(235, 235, 235, 0.80);
    font-size: 12px;
    padding: 1em;
    display: none;
}
.back-to-top:hover {    
    background-color: rgba(135, 135, 135, 0.50);
}
</style>
<div class="back-to-top">
<a href="#top">Back to top</a> | <a href="mailto:sacha@sachachua.com">E-mail me</a>
</div>
<script type="text/javascript">
    var offset = 220;
    var duration = 500;
    jQuery(window).scroll(function() {
        if (jQuery(this).scrollTop() > offset) {
            jQuery('.back-to-top').fadeIn(duration);
        } else {
            jQuery('.back-to-top').fadeOut(duration);
        }
    });
</script>
</div>
</body>
</html>
